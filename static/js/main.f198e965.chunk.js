(this["webpackJsonpschedule-f"]=this["webpackJsonpschedule-f"]||[]).push([[0],{121:function(e,t,c){},134:function(e,t,c){},135:function(e,t,c){},136:function(e,t,c){"use strict";c.r(t);var n=c(0),r=c.n(n),s=c(25),i=c.n(s),a=c(26),l=c.n(a),o=(c(115),c(21)),u=c(19),d="https://schedule-all-univers.herokuapp.com",h="schedule",j="main",b="search",f={activePanel:j,history:[h]},O=Object(o.c)({name:"navigation",initialState:f,reducers:{setActivePanel:function(e,t){e.activePanel=t.payload}}}),p=O.actions.setActivePanel,x=O.reducer,m=c(22),g=c.n(m),v=c(27),y={schedule:{getSchedule:function(){var e=Object(v.a)(g.a.mark((function e(t){var c,n,r,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.univer,n=t.tail,r=[d,"schedule",c,n].join("/"),e.next=4,fetch(r);case 4:return s=e.sent,e.next=7,s.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),searchSchedule:function(){var e=Object(v.a)(g.a.mark((function e(t){var c,n,r,s;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=t.univer,n=t.q,r=[d,"schedule/search",c,n].join("/"),e.next=4,fetch(r);case 4:return s=e.sent,e.next=7,s.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}},w=Object(o.b)("schedule/request",function(){var e=Object(v.a)(g.a.mark((function e(t,c){var n,r,s,i,a,l;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.univer,r=t.tail,s=c.getState(),i=s.schedule.scheduleHistory,!(a=i.find((function(e){return e.id===r})))){e.next=8;break}return e.abrupt("return",{record:a,isUniq:!1});case 8:return e.next=10,y.schedule.getSchedule({univer:n,tail:r});case 10:return l=e.sent,e.abrupt("return",{record:{id:r,data:l},isUniq:!0});case 12:case"end":return e.stop()}}),e)})));return function(t,c){return e.apply(this,arguments)}}()),_=Object(o.b)("schedule/search/request",y.schedule.searchSchedule),k=Object(o.c)({name:"schedule",initialState:{isLoading:!1,error:null,schedule:null,scheduleHistory:[],scheduleHistoryHrefs:[],isSearchLoading:!1,searchError:null,searchedSchedules:[]},reducers:{scheduleHistoryBack:function(e){e.scheduleHistoryHrefs.pop();var t=e.scheduleHistoryHrefs[e.scheduleHistoryHrefs.length-1];if(t){var c=e.scheduleHistory.find((function(e){return e.id===t}));e.schedule=c.data}else e.schedule=null},clearScheduleHistory:function(e){e.scheduleHistoryHrefs=[],e.schedule=null}},extraReducers:function(e){e.addCase(w.pending,(function(e,t){e.isLoading=!0,e.error=null})).addCase(w.rejected,(function(e,t){e.isLoading=!1,e.error={message:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0435 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044f :(",payload:t.meta.arg}})).addCase(w.fulfilled,(function(e,t){e.isLoading=!1,e.error=null;var c=t.payload,n=c.isUniq,r=c.record;n&&e.scheduleHistory.push(r),e.scheduleHistoryHrefs.push(r.id),e.schedule=r.data})).addCase(_.pending,(function(e,t){e.isSearchLoading=!0,e.searchError=null})).addCase(_.rejected,(function(e,t){e.isSearchLoading=!1,e.searchError={message:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u0435 \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u044f :(",payload:t.meta.arg}})).addCase(_.fulfilled,(function(e,t){e.isSearchLoading=!1,e.searchError=null,e.searchedSchedules=t.payload}))}}),S=k.actions,H=S.scheduleHistoryBack,C=S.clearScheduleHistory,N=k.reducer,T=Object(u.b)({navigation:x,schedule:N}),E=Object(o.a)({reducer:T}),L=c(13),q=(c(121),c(10)),P=c(137),A=c(138),U=c(3),W=function(e){var t=e.id,c=Object(L.b)();return Object(U.jsxs)(q.m,{id:t,style:{paddingTop:64},children:[Object(U.jsx)(q.b,{mode:"image",header:"\u0427\u0438\u0441\u043b\u0438\u0442\u0435\u043b\u044c",subheader:"\u0414\u043e \u043a\u043e\u043d\u0446\u0430 \u0441\u0435\u043c\u0435\u0441\u0442\u0440\u0430",background:Object(U.jsx)("div",{style:{backgroundColor:"#65c063",backgroundImage:"url(https://sun9-59.userapi.com/7J6qHkTa_P8VKRTO5gkh6MizcCEefz04Y0gDmA/y6dSjdtPU4U.jpg)",backgroundPosition:"right bottom",backgroundSize:320,backgroundRepeat:"no-repeat"}}),actions:Object(U.jsx)(q.k,{style:{marginTop:4},header:"\u043e\u0441\u0442\u0430\u043b\u043e\u0441\u044c ".concat(5," \u0434\u043d."),children:Object(U.jsx)(q.q,{style:{width:"70%",marginTop:8,background:"gray"},value:60})})}),Object(U.jsx)(q.h,{children:Object(U.jsx)(q.d,{children:Object(U.jsx)(q.e,{after:Object(U.jsx)(P.a,{}),onClick:function(){c(p(b))},children:"\u0418\u0441\u043a\u0430\u0442\u044c \u0440\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435"})})}),Object(U.jsx)(q.h,{children:Object(U.jsx)(q.d,{children:Object(U.jsx)(q.e,{after:Object(U.jsx)(A.a,{}),children:"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"})})})]})},R=c(24),I=c(139),V=c(140),z=c(141),B=c(142),J=(c(134),function(e){var t=e.lesson,c=e.onGoToSchedule;return Object(U.jsxs)("div",{className:"lesson-row",children:[Object(U.jsx)("div",{className:"lesson-row__time",children:t.time.map((function(e,t){return Object(U.jsx)("div",{className:"lesson-row__time-item lesson-row__time-item--".concat(0===t?"start":"end"),children:e},e)}))}),Object(U.jsxs)("div",{className:"lesson-row__body lesson-row__body--".concat(t.type),children:[Object(U.jsxs)("div",{className:"lesson-row__place",children:[Object(U.jsx)("span",{className:"lesson-row__type-title--".concat(t.type),children:t.typeTitle}),t.place]}),Object(U.jsx)("div",{className:"lesson-row__subject",children:t.subject}),Object(U.jsx)("div",{className:"lesson-row__fromWhoms",children:t.fromWhoms.map((function(e){return Object(U.jsx)("div",{className:"lesson-row__fromWhoms-item",onClick:function(){return c(e)},children:e.title},e.href)}))})]}),Object(U.jsx)("div",{className:"lesson-row__after"})]})}),K=(c(135),[{id:0,title:"\u041f\u041d"},{id:1,title:"\u0412\u0422"},{id:2,title:"\u0421\u0420"},{id:3,title:"\u0427\u0422"},{id:4,title:"\u041f\u0422"},{id:5,title:"\u0421\u0411"}]),G=[{id:0,title:"\u0427\u0438\u0441\u043b\u0438\u0442\u0435\u043b\u044c"},{id:1,title:"\u0417\u043d\u0430\u043c\u0435\u043d\u0430\u0442\u0435\u043b\u044c"}],D=function(e){var t,c=e.id,n=Object(L.b)(),s=Object(L.c)((function(e){return e.schedule})),i=s.isLoading,a=s.error,l=s.schedule,o=s.scheduleHistoryHrefs,u=r.a.useState(0),d=Object(R.a)(u,2),h=d[0],b=d[1],f=r.a.useState(0),O=Object(R.a)(f,2),x=O[0],m=O[1],g=function(){n(p(j)),n(C())},v=r.a.useState(!1),y=Object(R.a)(v,2),_=(y[0],y[1]),k=function(e){n(w({univer:"nsu",tail:e.href.slice(1)}))},S=r.a.useRef(null);return i?t=Object(U.jsx)(q.t,{}):a?t=Object(U.jsx)(q.p,{stretched:!0,action:Object(U.jsx)(q.c,{onClick:function(){n(w(a.payload))},children:"\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u044c"}),children:a.message}):l&&(t=Object(U.jsxs)(U.Fragment,{children:[Object(U.jsx)("div",{className:"schedule__card",ref:S,children:Object(U.jsx)(q.j,{style:{height:"100%"},slideIndex:h,onChange:function(e){return b(e)},children:K.map((function(e,t){var c=function(e,t,c){return e.filter((function(e){var n=e.day===t,r=e.week===c||2===e.week;return n&&r}))}(l.lessons,t,x);return Object(U.jsx)(q.d,{className:"schedule__body",children:0===c.length?Object(U.jsx)(q.p,{className:"schedule__empty-placeholder",icon:Object(U.jsx)(I.a,{style:{color:"teal"}}),children:"\u0412\u044b\u0445\u043e\u0434\u043d\u043e\u0439"}):c.map((function(e,c){return Object(U.jsx)(J,{lesson:e,onGoToSchedule:k},[t,c].join("-"))}))},t)}))})}),Object(U.jsxs)(q.d,{style:{marginTop:8},children:[Object(U.jsx)(q.u,{children:G.map((function(e){return Object(U.jsx)(q.v,{selected:e.id===x,onClick:function(){return m(e.id)},children:e.title},e.id)}))}),Object(U.jsx)(q.u,{children:K.map((function(e){return Object(U.jsx)(q.v,{selected:e.id===h,onClick:function(){return b(e.id)},children:e.title},e.id)}))}),Object(U.jsx)(q.s,{disabled:!0,before:Object(U.jsx)(V.a,{onClick:function(){1===o.length?g():n(H())},width:20,style:{marginRight:12,color:"teal"}}),after:Object(U.jsx)(z.a,{onClick:function(){console.log(),_(!0)},width:20,style:{color:"violet"}}),children:Object(U.jsx)(q.l,{children:l.title})})]})]})),Object(U.jsxs)(q.m,{id:c,children:[Object(U.jsx)(q.n,{separator:!1,left:Object(U.jsx)(B.a,{onClick:g})}),Object(U.jsx)(q.h,{className:"schedule__wrapper",children:t})]})},F=function(e){var t=e.id,c=Object(L.b)(),n=Object(L.c)((function(e){return e.schedule})),s=n.isSearchLoading,i=n.searchError,a=n.searchedSchedules,l=r.a.useState(""),o=Object(R.a)(l,2),u=o[0],d=o[1],b=r.a.useState(u),f=Object(R.a)(b,2),O=f[0],x=f[1];r.a.useEffect((function(){var e=window.setTimeout((function(){x(u)}),300);return function(){window.clearTimeout(e)}}),[u]),r.a.useEffect((function(){O&&c(_({univer:"nsu",q:O}))}),[O]);var m;return m=s?Object(U.jsx)(q.t,{}):i?Object(U.jsx)(q.p,{children:i.message}):0===a.length?Object(U.jsx)(q.p,{icon:Object(U.jsx)(I.a,{style:{color:"teal"}}),children:"\u041d\u0438\u0447\u0435\u0433\u043e \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e"}):a.map((function(e,t){return Object(U.jsx)(q.f,{onClick:function(){return function(e){c(w({univer:"nsu",tail:e.href})),c(p(h))}(e)},children:e.title},t)})),Object(U.jsxs)(q.m,{id:t,children:[Object(U.jsx)(q.n,{separator:!1,left:Object(U.jsx)(q.o,{onClick:function(){c(p(j))}}),children:"\u041f\u043e\u0438\u0441\u043a"}),Object(U.jsx)(q.i,{style:{paddingTop:24},vertical:"top",filled:!0,children:Object(U.jsx)(q.r,{after:null,value:u,onChange:function(e){d(e.target.value)}})}),Object(U.jsx)(q.h,{style:{marginTop:70},children:m})]})},M=function(){Object(L.b)();var e=Object(L.c)((function(e){return e.navigation})),t=e.activePanel,c=e.history;return r.a.useEffect((function(){document.body.setAttribute("scheme","space_gray")}),[]),Object(U.jsx)(q.g,{isWebView:!0,children:Object(U.jsx)(q.a,{children:Object(U.jsxs)(q.w,{activePanel:t,history:c,children:[Object(U.jsx)(W,{id:j}),Object(U.jsx)(F,{id:b}),Object(U.jsx)(D,{id:h})]})})})};l.a.send("VKWebAppInit"),l.a.subscribe((function(e){"VKWebAppUpdateConfig"===e.detail.type&&document.body.setAttribute("scheme",e.detail.data.scheme)})),i.a.render(Object(U.jsx)(L.a,{store:E,children:Object(U.jsx)(M,{})}),document.getElementById("root"))}},[[136,1,2]]]);
//# sourceMappingURL=main.f198e965.chunk.js.map