{"version":3,"sources":["constants.ts","store/slices/navigation.ts","api/index.ts","api/schedule.ts","store/slices/schedule.ts","store/rootReducer.ts","store/index.ts","panels/main/index.tsx","components/LessonRow/index.tsx","panels/schedule/index.tsx","utils/index.ts","panels/search/index.tsx","App.tsx","index.tsx"],"names":["BASE_URL","process","SCHEDULE_PANEL","MAIN_PANEL","SEARCH_PANEL","initialState","activePanel","history","navigationSlice","createSlice","name","reducers","setActivePanel","state","action","payload","actions","schedule","getSchedule","a","univer","tail","url","join","fetch","res","json","searchSchedule","q","requestSchedule","createAsyncThunk","api","requestSearchSchedule","scheduleSlice","isLoading","error","isSearchLoading","searchError","searchedSchedules","extraReducers","builder","addCase","pending","rejected","message","meta","arg","fulfilled","rootReducer","combineReducers","navigation","store","configureStore","reducer","MainPanel","id","dispatch","useDispatch","style","paddingTop","mode","header","subheader","background","backgroundColor","backgroundImage","backgroundPosition","backgroundSize","backgroundRepeat","marginTop","width","value","after","onClick","LessonRow","lesson","className","time","map","i","type","typeTitle","place","subject","fromWhoms","fromWhom","title","href","DAYS","WEEKS","SchedulePanel","content","useSelector","s","React","useState","currentDay","setCurrentDay","currentWeek","setCurrentWeek","cardRef","useRef","stretched","marginBottom","ref","height","slideIndex","onChange","d","_","lessons","day","week","filter","inDay","inWeek","getLessonsInDay","length","icon","color","j","selected","separator","left","SearchPanel","setQ","debQ","setDebQ","useEffect","timeout","window","setTimeout","clearTimeout","goToSchedule","vertical","filled","e","target","App","document","body","setAttribute","isWebView","bridge","send","subscribe","detail","data","scheme","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.7ac770ab.chunk.js","sourcesContent":["export const BASE_URL = process.env.REACT_APP_BASE_URL\n\nexport const SCHEDULE_PANEL = 'schedule'\nexport const MAIN_PANEL = 'main'\nexport const SEARCH_PANEL = 'search'","import { createSlice } from \"@reduxjs/toolkit\";\nimport { MAIN_PANEL, SCHEDULE_PANEL } from \"../../constants\";\nimport { PanelType } from \"../../types\";\n\ntype NavigationState = {\n  activePanel: PanelType\n  history: PanelType[]\n}\n\nconst initialState: NavigationState = {\n  // activePanel: SCHEDULE_PANEL,\n  activePanel: MAIN_PANEL,\n  history: [SCHEDULE_PANEL],\n}\n\nconst navigationSlice = createSlice({\n  name: 'navigation',\n  initialState,\n  reducers: {\n    setActivePanel(state, action)\n    {\n      state.activePanel = action.payload\n    },\n  },\n})\n\nexport const { setActivePanel } = navigationSlice.actions\nexport default navigationSlice.reducer","import schedule from './schedule'\n\nexport default {\n  schedule,\n}","import { BASE_URL } from \"../constants\"\n\nconst getSchedule = async ({\n  univer,\n  tail,\n} : {\n  univer: string,\n  tail: string,\n}) => {\n  const url = [ BASE_URL, 'schedule', univer, tail, ].join('/')\n  const res = await fetch(url)\n  return await res.json()\n}\n\nconst searchSchedule = async ({\n  univer,\n  q,\n} : {\n  univer: string,\n  q: string,\n}) => {\n  const url = [ BASE_URL, 'schedule/search', univer, q, ].join('/')\n  const res = await fetch(url)\n  return await res.json()\n}\n\nexport default {\n  getSchedule,\n  searchSchedule,\n}","import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\"\nimport { HrefTitle, Schedule } from \"../../types\"\nimport api from \"../../api\"\n\ntype ScheduleState = {\n  isLoading: boolean\n  error: {\n    message: string,\n    payload: any,\n  } | null\n  schedule: Schedule | null\n\n  isSearchLoading: boolean\n  searchError: {\n    message: string,\n    payload: any,\n  } | null\n  searchedSchedules: HrefTitle[]\n}\n\nexport const requestSchedule = createAsyncThunk(\n  'schedule/request',\n  api.schedule.getSchedule\n)\n\nexport const requestSearchSchedule = createAsyncThunk(\n  'schedule/search/request',\n  api.schedule.searchSchedule\n)\n\nconst initialState: ScheduleState = {\n  isLoading: false,\n  error: null,\n  schedule: null,\n\n  isSearchLoading: false,\n  searchError: null,\n  searchedSchedules: [],\n}\n\nconst scheduleSlice = createSlice({\n  name: 'schedule',\n  initialState,\n  reducers: {},\n  extraReducers(builder)\n  {\n    builder\n      .addCase(requestSchedule.pending, (state,action) => {\n        state.isLoading = true\n        state.error = null\n      })\n      .addCase(requestSchedule.rejected, (state,action) => {\n        state.isLoading = false\n        state.error = {\n          message: 'Ошибка при запросе расписания :(',\n          payload: action.meta.arg\n        }\n      })\n      .addCase(requestSchedule.fulfilled, (state,action) => {\n        state.isLoading = false\n        state.error = null\n        state.schedule = action.payload\n      })\n\n      .addCase(requestSearchSchedule.pending, (state,action) => {\n        state.isSearchLoading = true\n        state.searchError = null\n      })\n      .addCase(requestSearchSchedule.rejected, (state,action) => {\n        state.isSearchLoading = false\n        state.searchError = {\n          message: 'Ошибка при запросе расписания :(',\n          payload: action.meta.arg\n        }\n      })\n      .addCase(requestSearchSchedule.fulfilled, (state,action) => {\n        state.isSearchLoading = false\n        state.searchError = null\n        state.searchedSchedules = action.payload\n      })\n  },\n})\n\nexport const {} = scheduleSlice.actions\nexport default scheduleSlice.reducer","import { combineReducers } from \"@reduxjs/toolkit\"\n\nimport navigation from './slices/navigation'\nimport schedule from './slices/schedule'\n\nconst rootReducer = combineReducers({\n  navigation,\n  schedule,\n})\n\nexport type RootState = ReturnType<typeof rootReducer>\nexport default rootReducer","import { configureStore } from \"@reduxjs/toolkit\"\n\nimport rootReducer from './rootReducer'\n\nconst store = configureStore({ reducer : rootReducer })\n\nexport default store","import React from 'react'\nimport { Banner, Card, Cell, Div, InfoRow, Panel, Progress } from '@vkontakte/vkui'\nimport { Icon28Search, Icon28SettingsOutline } from '@vkontakte/icons';\nimport { PanelProps } from '../../types'\nimport { useDispatch } from 'react-redux';\nimport { setActivePanel } from '../../store/slices/navigation';\nimport { SEARCH_PANEL } from '../../constants';\n\nconst MainPanel: React.FC<PanelProps> = ({\n  id,\n}) => {\n  const dispatch = useDispatch()\n\n  const goToSearchSchedule = () => {\n    dispatch(setActivePanel(SEARCH_PANEL))\n  }\n\n  return (\n    <Panel id={id} style={{paddingTop: 64}}>\n      <Banner\n        mode=\"image\"\n        header={true && 'Числитель'}\n        subheader=\"До конца семестра\"\n        background={\n          <div\n            style={{\n              backgroundColor: '#65c063',\n              backgroundImage: 'url(https://sun9-59.userapi.com/7J6qHkTa_P8VKRTO5gkh6MizcCEefz04Y0gDmA/y6dSjdtPU4U.jpg)',\n              backgroundPosition: 'right bottom',\n              backgroundSize: 320,\n              backgroundRepeat: 'no-repeat',\n            }}\n          />\n        }\n        actions={\n          // <Button\n          //   disabled\n          //   mode=\"overlay_primary\"\n          // >Подробнее</Button>\n          <InfoRow style={{marginTop:4}} header={`осталось ${5} дн.`}>\n            <Progress\n              style={{width:'70%', marginTop : 8, background : 'gray'}}\n              value={(60 / 100) * 100}\n            />\n          </InfoRow>\n        }\n      />\n\n      <Div>\n        <Card>\n          <Cell\n            after={<Icon28Search/>}\n            onClick={goToSearchSchedule}\n          >Искать расписание</Cell>\n        </Card>\n      </Div>\n      \n      <Div>\n        <Card>\n          <Cell\n            after={<Icon28SettingsOutline/>}\n          >Настройки</Cell>\n        </Card>\n      </Div>\n    </Panel>\n  )\n}\n\nexport default MainPanel","import { Panel } from '@vkontakte/vkui'\nimport React from 'react'\nimport { Lesson } from '../../types'\nimport './LessonRow.sass'\n\ntype LessonRowProps = {\n  lesson: Lesson\n}\n\nconst LessonRow: React.FC<LessonRowProps> = ({\n  lesson,\n}) => {\n  return (\n    <div className=\"lesson-row\">\n      <div className=\"lesson-row__time\">\n        {lesson.time.map((time, i) => {\n          return <div\n            key={time}\n            className={`lesson-row__time-item lesson-row__time-item--${i === 0 ? 'start' : 'end'}`}\n          >{time}</div>\n        })}\n      </div>\n      <div className={`lesson-row__body lesson-row__body--${lesson.type}`}>\n        <div className=\"lesson-row__place\">\n          <span className={`lesson-row__type-title--${lesson.type}`}>\n            {lesson.typeTitle}\n          </span>\n          {lesson.place}\n        </div>\n        <div className=\"lesson-row__subject\">\n          {lesson.subject}\n        </div>\n        <div className=\"lesson-row__fromWhoms\">\n          {lesson.fromWhoms.map(fromWhom => {\n            return <div\n              key={fromWhom.href}\n              className=\"lesson-row__fromWhoms-item\"\n            >{fromWhom.title}</div>\n          })}\n        </div>\n      </div>\n      <div className=\"lesson-row__after\"></div>\n    </div>\n  )\n}\n\nexport default LessonRow","import React from 'react'\nimport { Button, Card, Div, Gallery, Header, Link, Panel, PanelHeader, PanelHeaderBack, Placeholder, Spinner, Tabs, TabsItem } from '@vkontakte/vkui'\nimport { Icon56GhostOutline } from '@vkontakte/icons';\nimport { useDispatch, useSelector } from 'react-redux'\nimport LessonRow from '../../components/LessonRow'\nimport { RootState } from '../../store/rootReducer'\nimport { DayRange, PanelProps, WeekRange } from '../../types'\nimport { getLessonsInDay } from '../../utils'\nimport './Schedule.sass'\nimport { requestSchedule } from '../../store/slices/schedule';\nimport { setActivePanel } from '../../store/slices/navigation';\nimport { MAIN_PANEL } from '../../constants';\n\nconst DAYS = [\n  { id: 0, title: 'ПН' },\n  { id: 1, title: 'ВТ' },\n  { id: 2, title: 'СР' },\n  { id: 3, title: 'ЧТ' },\n  { id: 4, title: 'ПТ' },\n  { id: 5, title: 'СБ' },\n]\nconst WEEKS = [\n  { id: 0, title: 'Числитель'},\n  { id: 1, title: 'Знаменатель'},\n]\n\nconst SchedulePanel: React.FC<PanelProps> = ({\n  id,\n}) => {\n  const dispatch = useDispatch()\n  const { isLoading, error, schedule } = useSelector((s: RootState) => s.schedule)\n\n  const [currentDay, setCurrentDay] = React.useState<DayRange>(0)\n  const [currentWeek, setCurrentWeek] = React.useState<WeekRange>(0)\n\n  const goBack = () => {\n    dispatch(setActivePanel(MAIN_PANEL))\n  }\n\n  const cardRef = React.useRef<HTMLDivElement>(null)\n\n  let content\n\n  if(isLoading)\n  {\n    content = <Spinner />\n  }\n  else if(error)\n  {\n    content = <Placeholder\n      stretched\n      action={\n        <Button onClick={() => {\n          dispatch(requestSchedule(error.payload))\n        }}>Повторить</Button>}\n    >{error.message}</Placeholder>\n  }\n  else if(schedule)\n  {\n    content = ( <>\n      <Card style={{marginBottom:8}}>\n        <Header>\n          <Link>{schedule.title}</Link>\n        </Header>\n      </Card>\n      \n      <div className=\"schedule__card\" ref={cardRef}>\n        <Gallery\n          style={{height:'100%'}}\n          slideIndex={currentDay}\n          onChange={d => setCurrentDay(d as DayRange)}\n        >\n          {DAYS.map((_,i) => {\n            const lessons = getLessonsInDay(schedule.lessons, i as DayRange, currentWeek)\n\n            return <Card key={i} className=\"schedule__body\">\n              {lessons.length === 0\n                ? <Placeholder className=\"schedule__empty-placeholder\" icon={<Icon56GhostOutline style={{color:\"teal\"}}/>}>Выходной</Placeholder>\n                : lessons.map((lesson, j) => {\n                    return <LessonRow key={[i,j].join('-')} lesson={lesson} />\n                  })}\n            </Card>\n          })}\n        </Gallery>\n      </div>\n\n      <Card style={{marginTop:8}}>\n        <Tabs>\n          {WEEKS.map(week => {\n            return <TabsItem\n              key={week.id}\n              selected={week.id === currentWeek}\n              onClick={() => setCurrentWeek(week.id as WeekRange)}\n            >{week.title}</TabsItem>\n          })}\n        </Tabs>\n        <Tabs>\n          {DAYS.map(day => {\n            return <TabsItem\n              key={day.id}\n              selected={day.id === currentDay}\n              onClick={() => setCurrentDay(day.id as DayRange)}\n            >{day.title}</TabsItem>\n          })}\n        </Tabs>\n      </Card>\n    </>)\n  }\n\n  return (\n    <Panel id={id}>\n      <PanelHeader\n        separator={false}\n        left={\n          <PanelHeaderBack onClick={goBack} />\n        }\n      >Расписание</PanelHeader>\n      <Div className=\"schedule__wrapper\">\n        {content}\n      </Div>\n    </Panel>\n  )\n}\n\nexport default SchedulePanel","import { DayRange, Lesson, WeekRange } from \"../types\";\n\nexport const getLessonsInDay = (\n  lessons: Lesson[],\n  day: DayRange,\n  week: WeekRange\n): Lesson[] => {\n  return lessons.filter(lesson => {\n    const inDay = lesson.day === day\n    const inWeek = lesson.week === week || lesson.week === 2\n\n    return inDay && inWeek\n  })\n}","import React, { ChangeEvent } from 'react'\nimport { Button, CellButton, Div, FixedLayout, Panel, PanelHeader, PanelHeaderBack, Placeholder, Search, Spinner } from '@vkontakte/vkui'\nimport { Icon56GhostOutline } from '@vkontakte/icons'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { MAIN_PANEL, SCHEDULE_PANEL } from '../../constants'\nimport { RootState } from '../../store/rootReducer'\nimport { setActivePanel } from '../../store/slices/navigation'\nimport { requestSchedule, requestSearchSchedule } from '../../store/slices/schedule'\nimport { HrefTitle, PanelProps } from '../../types'\n\nconst SearchPanel: React.FC<PanelProps> = ({\n  id,\n}) => {\n  const dispatch = useDispatch()\n  const { isSearchLoading, searchError, searchedSchedules, } = useSelector((s: RootState) => s.schedule)\n\n  const [q, setQ] = React.useState<string>('')\n  const handleQChange = (e: ChangeEvent<HTMLInputElement>) => {\n    setQ(e.target.value)\n  }\n\n  const [debQ, setDebQ] = React.useState(q)\n  React.useEffect(() => {\n    const timeout = window.setTimeout(() => {\n      setDebQ(q)\n    }, 300)\n\n    return () => {\n      window.clearTimeout(timeout)\n    }\n  }, [q])\n\n  React.useEffect(() => {\n    if(debQ)\n    {\n      dispatch(requestSearchSchedule({\n        univer: 'nsu',\n        q: debQ,\n      }))\n    }\n  }, [debQ])\n\n  const goToMainPanel = () => {\n    dispatch(setActivePanel(MAIN_PANEL))\n  }\n\n  const goToSchedule = (schedule: HrefTitle) => {\n    dispatch(requestSchedule({\n      univer: 'nsu',\n      tail: schedule.href,\n    }))\n    dispatch(setActivePanel(SCHEDULE_PANEL))\n  }\n\n  let content\n\n  if(isSearchLoading)\n  {\n    content = <Spinner />\n  }\n  else if(searchError)\n  {\n    content = <Placeholder\n      // action={\n      //   <Button onClick={() => {\n      //     dispatch(requestSchedule(searchError.payload))\n      //   }}>Повторить</Button>\n      // }\n    >{searchError.message}</Placeholder>\n  }\n  else if(searchedSchedules.length === 0)\n  {\n    content = <Placeholder\n      icon={<Icon56GhostOutline style={{color:\"teal\"}} />}\n    >Ничего не найдено</Placeholder>\n  }\n  else\n  {\n    content = searchedSchedules.map((schedule, i) => {\n      return <CellButton\n        key={i}\n        onClick={() => goToSchedule(schedule)}\n      >{schedule.title}</CellButton>\n    })\n  }\n\n  return (\n    <Panel id={id}>\n      <PanelHeader\n        separator={false}\n        left={\n          <PanelHeaderBack onClick={goToMainPanel} />\n        }\n      >Поиск</PanelHeader>\n\n      <FixedLayout style={{paddingTop:24}} vertical=\"top\" filled>\n        <Search\n          after={null}\n          value={q}\n          onChange={handleQChange}\n        />\n      </FixedLayout>\n\n      <Div style={{marginTop:70}}>{content}</Div>\n    </Panel>\n  )\n}\n\nexport default SearchPanel","import { AppRoot, ConfigProvider, View } from '@vkontakte/vkui';\nimport React from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { MAIN_PANEL, SCHEDULE_PANEL, SEARCH_PANEL } from './constants';\nimport MainPanel from './panels/main';\nimport SchedulePanel from './panels/schedule';\nimport SearchPanel from './panels/search';\nimport { RootState } from './store/rootReducer';\n\n\nconst App: React.FC = () => {\n  const dispatch = useDispatch()\n  const { activePanel, history } = useSelector((s: RootState) => s.navigation)\n\n  React.useEffect(() => {\n    document.body.setAttribute('scheme', 'space_gray')\n  },[])\n\n  return (\n    <ConfigProvider isWebView={true}>\n      <AppRoot>\n        <View\n          activePanel={activePanel}\n          history={history}\n        >\n          <MainPanel id={MAIN_PANEL} />\n          <SearchPanel id={SEARCH_PANEL} />\n          <SchedulePanel id={SCHEDULE_PANEL} />\n        </View>\n      </AppRoot>\n    </ConfigProvider>\n  )\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport bridge from '@vkontakte/vk-bridge'\nimport '@vkontakte/vkui/dist/vkui.css'\n\nimport store from './store'\nimport { Provider } from 'react-redux'\n\nimport './index.sass';\n\nimport App from './App';\n\nbridge.send('VKWebAppInit')\nbridge.subscribe(e => {\n  if(e.detail.type === 'VKWebAppUpdateConfig')\n    document.body.setAttribute('scheme', e.detail.data.scheme)\n})\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}