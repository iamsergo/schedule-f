{"version":3,"sources":["constants.ts","store/slices/navigation.ts","api/schedule.ts","api/config.ts","api/user.ts","api/index.ts","store/slices/schedule.ts","utils/index.ts","store/slices/config.ts","store/slices/user.ts","store/rootReducer.ts","store/index.ts","components/LessonRow/index.tsx","components/ScheduleBody/index.tsx","panels/main/index.tsx","panels/schedule/index.tsx","panels/search/index.tsx","panels/settings/index.tsx","components/AppActions/index.tsx","components/ActionsModal/index.tsx","App.tsx","index.tsx"],"names":["BASE_URL","process","GROUP_ID","SCHEDULE_PANEL","MAIN_PANEL","SEARCH_PANEL","SETTINGS_PANEL","initialState","activePanel","history","activeModal","navigationSlice","createSlice","name","reducers","setActivePanel","state","action","payload","setActiveModal","actions","schedule","getSchedule","a","univer","tail","queryTail","URLSearchParams","toString","url","join","fetch","res","json","searchSchedule","q","config","getUniverList","getUser","id","user","updateUserUniver","univerId","options","method","headers","body","JSON","stringify","deleteUserUniver","api","updateUserSchedule","scheduleId","deleteUserSchedule","requestSchedule","createAsyncThunk","thunkAPI","href","getState","scheduleHistory","userSchedule","find","record","isUniq","data","requestSearchSchedule","scheduleSlice","isLoading","error","lessonStats","scheduleHistoryHrefs","isSearchLoading","searchError","searchedSchedules","scheduleHistoryBack","pop","currentScheduleHref","length","currentSchedule","clearScheduleHistory","clearSearchedSchedules","setLessonStats","extraReducers","builder","addCase","pending","rejected","message","meta","arg","fulfilled","push","getLessonsInDay","lessons","day","week","filter","lesson","inDay","inWeek","getFromWhomsList","lessonsMap","forEach","fromWhoms","fromWhom","Object","values","isCurrentWeek","now","Date","getTime","range","start","end","requestConfigUnivers","configSlice","univerList","currentUniver","passDays","countDays","toEndDays","toEndPercent","currentDay","currentWeek","setCurrentUniver","dayId","getDay","getCurrentDay","weeks","weekType","getCurrentWeek","startDate","endDate","DAYS","Math","ceil","getDaysStats","setConfig","requestGetUser","requestUpdateUserUniver","requestDeleteUserUniver","requestUpdateUserSchedule","requestDeleteUserSchedule","userSlice","isLoaderShowing","isUniverLoading","isScheduleLoading","userData","setUserData","setIsLoaderShowing","rootReducer","combineReducers","navigation","store","configureStore","reducer","LessonRow","current","onGoToSchedule","getStats","className","time","map","i","type","typeTitle","place","onClick","subject","group","title","ScheduleBody","today","onGetStats","icon","style","color","j","lessonTime","timeString","split","s","startHours","startMinutes","setHours","endHours","endMinutes","isCurrentLesson","MainPanel","content","dispatch","useDispatch","useSelector","isUserLoading","userError","isConfigLoading","configError","goToSearchSchedule","goToSettings","goToSchedule","code","React","useState","fromWhomsIsOpen","setFromWhomsIsOpen","weeksIsOpen","setWeeksIsOpen","timeLessonsIsOpen","setTimeLessonsIsOpen","paddingTop","userMessage","configMessage","stretched","univerContent","scheduleContent","univerInfoContent","subtitle","toLocaleDateString","margin","background","value","after","width","height","lessonsToday","todayString","disabled","fill","padding","weekEnd","rangeString","weekPassed","description","textDecoration","opacity","timeLessons","separator","left","WEEKS","SchedulePanel","their","my","setPopout","activeDay","setActiveDay","activeWeek","setActiveWeek","isDiffShowing","setIsDiffShowing","toggleDiffShowing","goToMain","saveSchedule","deleteSchedule","cardRef","useRef","ls","theirLesson","myLesson","b","dayEqual","lessonNumEqual","weekEqual","groupEqual","isIntersection","ref","slideIndex","onChange","d","_","stats","lec","pass","total","pr","lab","thisLessons","thisLessons0","l","thisLessons1","thisLessons2","weeks0Count","w","weeks1Count","nowMs","currentWeekIdx","findIndex","passedWeeks","slice","weeksPassed0Count","weeksPassed1Count","n","typeLesson","getStatsForLesson","marginTop","selected","before","marginRight","toggleScheduleItem","autoclose","popout","onClose","iosCloseItem","mode","transform","baseUrl","SearchPanel","setQ","searchRef","useEffect","window","setTimeout","focus","debQ","setDebQ","timeout","clearTimeout","textAlign","vertical","filled","getRef","placeholder","e","target","SettingsPanel","userUniverId","setUniver","header","top","bottom","size","AppActions","closeModal","platform","usePlatform","bridge","send","then","console","log","catch","group_id","link","ActionsModal","subheader","right","level","weight","startDateStartOfWeek","entries","isFirstLoading","App","document","setAttribute","location","search","reduce","queryParam","key","handleSetPopout","initApp","addToHomeScreenInfo","is_feature_supported","is_added_to_home_screen","is_favorite","is_member","openModal","isWebView","modal","subscribe","detail","scheme","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.a39d07f1.chunk.js","sourcesContent":["export const BASE_URL = process.env.REACT_APP_BASE_URL\n\nexport const GROUP_ID = 198278031\n\nexport const SCHEDULE_PANEL = 'schedule'\nexport const MAIN_PANEL = 'main'\nexport const SEARCH_PANEL = 'search'\nexport const SETTINGS_PANEL = 'settings'","import { createSlice } from \"@reduxjs/toolkit\";\nimport { MAIN_PANEL } from \"../../constants\";\nimport { PanelType } from \"../../types\";\n\ntype NavigationState = {\n  activePanel: PanelType\n  history: PanelType[]\n  activeModal: string | null\n}\n\nconst initialState: NavigationState = {\n  activePanel: MAIN_PANEL,\n  history: [MAIN_PANEL],\n  activeModal: null,\n}\n\nconst navigationSlice = createSlice({\n  name: 'navigation',\n  initialState,\n  reducers: {\n    setActivePanel(state, action)\n    {\n      state.activePanel = action.payload\n    },\n    setActiveModal(state, action)\n    {\n      state.activeModal = action.payload\n    }\n  },\n})\n\nexport const { setActivePanel, setActiveModal } = navigationSlice.actions\nexport default navigationSlice.reducer","import { BASE_URL } from \"../constants\"\nimport { HrefTitle, Schedule } from \"../types\"\n\nconst getSchedule = async ({\n  univer,\n  tail,\n} : {\n  univer: string,\n  tail: string,\n}): Promise<Schedule> => {\n  const queryTail = new URLSearchParams(`tail=${tail}`).toString()\n  const url = [BASE_URL, \"schedule\", univer].join(\"/\") + '?' + queryTail\n  const res = await fetch(url)\n  return await res.json()\n}\n\nconst searchSchedule = async ({\n  univer,\n  q,\n} : {\n  univer: string,\n  q: string,\n}) : Promise<HrefTitle[]> => {\n  const url = [ BASE_URL, 'schedule/search', univer, q, ].join('/')\n  const res = await fetch(url)\n  return await res.json()\n}\n\nconst schedule = {\n  getSchedule,\n  searchSchedule,\n}\n\nexport default schedule","import { BASE_URL } from \"../constants\"\nimport { Univer } from \"../types\"\n\nconst getUniverList = async (): Promise<Univer[]> => {\n  const url = [ BASE_URL, 'univers'].join('/')\n  const res = await fetch(url)\n  return await res.json()\n}\n\nconst config = {\n  getUniverList,\n}\n\nexport default config","import { BASE_URL } from \"../constants\"\nimport { User } from \"../types\"\n\nconst getUser = async (id: number): Promise<User> => {\n  const url = [ BASE_URL, 'users', id].join('/')\n  const res = await fetch(url)\n  const user = await res.json()\n\n  return user  \n}\n\nconst updateUserUniver = async ({\n  id, univerId,\n}: { id: number, univerId: number }): Promise<User> => {\n  const url = [ BASE_URL, 'users', id, 'univer'].join('/')\n  const options = {\n    method: 'PUT',\n    headers: { 'Content-Type': 'application/json;charset=utf-8' },\n    body: JSON.stringify({univerId}),\n  }\n  const res = await fetch(url, options)\n  const user = await res.json()\n\n  return user  \n}\n\nconst deleteUserUniver = async (id: number): Promise<User> => {\n  const url = [ BASE_URL, 'users', id, 'univer'].join('/')\n  const options = {\n    method: 'DELETE',\n  }\n  const res = await fetch(url, options)\n  const user = await res.json()\n\n  return user  \n}\n\nconst updateUserSchedule = async ({\n  id, scheduleId,\n}: { id: number, scheduleId: string }): Promise<User> => {\n  const url = [ BASE_URL, 'users', id, 'schedule'].join('/')\n  const options = {\n    method: 'PUT',\n    headers: { 'Content-Type': 'application/json;charset=utf-8' },\n    body: JSON.stringify({scheduleId}),\n  }\n  const res = await fetch(url, options)\n  const user = await res.json()\n\n  return user  \n}\n\nconst deleteUserSchedule = async (id: number): Promise<User> => {\n  const url = [ BASE_URL, 'users', id, 'schedule'].join('/')\n  const options = {\n    method: 'DELETE',\n  }\n  const res = await fetch(url, options)\n  const user = await res.json()\n\n  return user  \n}\n\nconst user = {\n  getUser,\n  updateUserSchedule,\n  deleteUserSchedule,\n  updateUserUniver,\n  deleteUserUniver,\n}\n\nexport default user","import schedule from './schedule'\nimport config from './config'\nimport user from './user'\n\nconst api = {\n  schedule,\n  config,\n  user,\n}\n\nexport default api","import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\"\nimport { HrefTitle, Schedule, Stats } from \"../../types\"\nimport api from \"../../api\"\nimport { RootState } from \"../rootReducer\"\n\ntype ScheduleHistoryRecord = {\n    id: string,\n    data: Schedule\n  }\n\ntype ScheduleState = {\n  isLoading: boolean\n  error: {\n    message: string,\n    payload: any,\n  } | null\n  schedule: Schedule | null\n  lessonStats: {\n    title: string\n    stats: Stats\n    fromWhoms: HrefTitle[]\n  } | null\n  scheduleHistory: ScheduleHistoryRecord[]\n  scheduleHistoryHrefs: string[]\n\n  q: string\n  isSearchLoading: boolean\n  searchError: {\n    message: string,\n    payload: any,\n  } | null\n  searchedSchedules: HrefTitle[]\n}\n\nexport const requestSchedule = createAsyncThunk(\n  'schedule/request',\n  async ({ univer, tail: href }: {\n    univer: string,\n    tail: string,\n  }, thunkAPI): Promise<{record: ScheduleHistoryRecord, isUniq: boolean }> => {\n    const state = (thunkAPI.getState() as RootState)\n    const scheduleHistory = state.schedule.scheduleHistory\n    const userSchedule = state.user.user?.schedule\n    \n    const schedule = scheduleHistory.find(schedule => schedule.id === href)\n    if(schedule)\n    {\n      return { record: schedule, isUniq: false}\n    }\n    else if(userSchedule && userSchedule.href === href)\n    {\n      return {\n        record: { id: href, data: userSchedule },\n        isUniq: true,\n      }\n    }\n    else\n    {\n      const schedule = await api.schedule.getSchedule({ univer, tail: href })\n      return {\n        record: { id: href, data: schedule },\n        isUniq: true,\n      }\n    }\n  }\n)\n\nexport const requestSearchSchedule = createAsyncThunk(\n  'schedule/search/request',\n  api.schedule.searchSchedule\n)\n\nconst initialState: ScheduleState = {\n  isLoading: false,\n  error: null,\n  schedule: null,\n  lessonStats: null,\n  scheduleHistory: [],\n  scheduleHistoryHrefs: [],\n\n  q: '',\n  isSearchLoading: false,\n  searchError: null,\n  searchedSchedules: [],\n}\n\nconst scheduleSlice = createSlice({\n  name: 'schedule',\n  initialState,\n  reducers: {\n    scheduleHistoryBack(state)\n    {\n      state.scheduleHistoryHrefs.pop()\n      const currentScheduleHref = state.scheduleHistoryHrefs[state.scheduleHistoryHrefs.length - 1]\n      if(currentScheduleHref)\n      {\n        const currentSchedule = state.scheduleHistory.find(schedule => schedule.id === currentScheduleHref)!\n        state.schedule = currentSchedule.data\n      }\n      else\n      {\n        state.schedule = null\n      }\n    },\n    clearScheduleHistory(state)\n    {\n      state.scheduleHistoryHrefs = []\n      state.schedule = null\n    },\n    clearSearchedSchedules(state)\n    {\n      state.searchedSchedules = []\n    },\n    setLessonStats(state,action)\n    {\n      state.lessonStats = action.payload\n    },\n  },\n  extraReducers(builder)\n  {\n    builder\n      .addCase(requestSchedule.pending, (state) => {\n        state.isLoading = true\n        state.error = null\n      })\n      .addCase(requestSchedule.rejected, (state,action) => {\n        state.isLoading = false\n        state.error = {\n          message: 'Ошибка при запросе расписания :(',\n          payload: action.meta.arg\n        }\n      })\n      .addCase(requestSchedule.fulfilled, (state,action) => {\n        state.isLoading = false\n        state.error = null\n\n        const { isUniq, record } = action.payload\n\n        if(isUniq)\n        {\n          state.scheduleHistory.push(record)\n        }\n\n        state.scheduleHistoryHrefs.push(record.id)\n        state.schedule = record.data\n      })\n\n      .addCase(requestSearchSchedule.pending, (state) => {\n        state.isSearchLoading = true\n        state.searchError = null\n      })\n      .addCase(requestSearchSchedule.rejected, (state,action) => {\n        state.isSearchLoading = false\n        state.searchError = {\n          message: 'Ошибка при запросе расписания :(',\n          payload: action.meta.arg\n        }\n      })\n      .addCase(requestSearchSchedule.fulfilled, (state,action) => {\n        state.isSearchLoading = false\n        state.searchError = null\n        state.searchedSchedules = action.payload\n      })\n  },\n})\n\nexport const {\n  scheduleHistoryBack,\n  clearScheduleHistory,\n  clearSearchedSchedules,\n  setLessonStats,\n} = scheduleSlice.actions\nexport default scheduleSlice.reducer","import { DayRange, HrefTitle, Lesson, Stats, Univer, WeekRange, WeekTypeRange } from \"../types\";\n\nexport const getLessonsInDay = (\n  lessons: Lesson[],\n  day: DayRange,\n  week: WeekRange\n): Lesson[] => {\n  return lessons.filter(lesson => {\n    const inDay = lesson.day === day\n    const inWeek = lesson.week === week || lesson.week === 2\n\n    return inDay && inWeek\n  })\n}\n\nexport const getFromWhomsList = (lessons: Lesson[]): HrefTitle[] => {\n  const lessonsMap: {\n    [key: string]: HrefTitle\n  } = {}\n  lessons.forEach(lesson => {\n    lesson.fromWhoms.forEach(fromWhom => {\n      if(!lessonsMap[fromWhom.href])\n      {\n        lessonsMap[fromWhom.href] = fromWhom\n      }\n    })\n  })\n\n  return Object.values(lessonsMap)\n}\n\nexport const getCurrentDay = (): DayRange => {\n  const dayId = new Date().getDay()\n\n  return (dayId > 0 ? dayId - 1 : dayId) as DayRange\n}\n\nexport const getDaysStats = (\n  startDate: number,\n  endDate: number,\n): {\n  passDays: number,\n  countDays: number,\n  toEndDays: number,\n} => {\n  const DAYS = 1000 * 60 * 60 * 24\n  const now = new Date().getTime()\n  const start = new Date(startDate).getTime()\n  const end = new Date(endDate).getTime()\n\n  const countDays = Math.ceil((end - start) / DAYS)\n  const passDays = Math.ceil((now - start) / DAYS)\n  const toEndDays = Math.ceil((end - now) / DAYS)\n\n  return { passDays, countDays, toEndDays }\n}\n\nexport const isPassWeek = (weekEnd: number): boolean => {\n  const now = new Date().getTime()\n  return now > weekEnd\n}\n\nexport const isCurrentWeek = (week: WeekTypeRange): boolean => {\n  const now = new Date().getTime()\n  const [start,end] = week.range\n  return start <= now && now <= end\n}\n\nexport const getCurrentWeek = (weeks: WeekTypeRange[]): WeekRange => {\n  const currentWeek = weeks.find(week => isCurrentWeek(week))\n\n  if(!currentWeek) return 0\n\n  return currentWeek.weekType\n}\n\nexport const getDiff = (their: Lesson[], my: Lesson[]): Lesson[] => {\n  const isIntersection = (a: Lesson, b: Lesson) => {\n    const dayEqual = a.day === b.day\n    const lessonNumEqual = a.lesson === b.lesson\n    const weekEqual = a.week === b.week || a.week === 2 || b.week === 2\n    const groupEqual = a.group === b.group || a.group === 2 || b.group === 2\n\n    return dayEqual && lessonNumEqual && weekEqual && groupEqual\n  }\n\n  return their.filter(theirLesson => !my.find(myLesson => isIntersection(theirLesson, myLesson)))\n}\n\nexport const getStatsForLesson = ({\n  lesson,\n  lessons,\n  currentUniver,\n}: {\n  lesson: Lesson,\n  lessons: Lesson[],\n  currentUniver: Univer\n}): { stats: Stats, fromWhoms: HrefTitle[] } => {\n  const { subject, time } = lesson\n  const { weeks } = currentUniver\n\n  const stats: Stats = {\n    lec: {pass:0,total:0},\n    pr: {pass:0,total:0},\n    lab: {pass:0,total:0},\n  }\n\n  const thisLessons = lessons.filter(lesson => lesson.subject === subject)\n  const thisLessons0 = thisLessons.filter(l => l.week === 0)\n  const thisLessons1 = thisLessons.filter(l => l.week === 1)\n  const thisLessons2 = thisLessons.filter(l => l.week === 2)\n\n  const weeks0Count = weeks.filter(w => w.weekType === 0).length\n  const weeks1Count = weeks.filter(w => w.weekType === 1).length\n\n  stats.lec.total =\n    weeks0Count * thisLessons0.filter(l => l.type === 0).length +\n    weeks1Count * thisLessons1.filter(l => l.type === 0).length +\n    (weeks0Count + weeks1Count) * thisLessons2.filter(l => l.type === 0).length\n\n  stats.pr.total =\n    weeks0Count * thisLessons0.filter(l => l.type === 1).length +\n    weeks1Count * thisLessons1.filter(l => l.type === 1).length +\n    (weeks0Count + weeks1Count) * thisLessons2.filter(l => l.type === 1).length\n\n  stats.lab.total =\n    weeks0Count * thisLessons0.filter(l => l.type === 2).length +\n    weeks1Count * thisLessons1.filter(l => l.type === 2).length +\n    (weeks0Count + weeks1Count) * thisLessons2.filter(l => l.type === 2).length\n\n\n  const now = new Date()\n  const nowMs = now.getTime()\n\n  const currentWeekIdx = weeks.findIndex(w => {\n    const [start, end] = w.range\n    return start <= nowMs && nowMs <= end\n  })\n  const passedWeeks = weeks.slice(0, currentWeekIdx)\n\n  const weeksPassed0Count = passedWeeks.filter(w => w.weekType === 0).length\n  const weeksPassed1Count = passedWeeks.filter(w => w.weekType === 1).length\n\n  stats.lec.pass =\n    weeksPassed0Count * thisLessons0.filter(l => l.type === 0).length +\n    weeksPassed1Count * thisLessons1.filter(l => l.type === 0).length +\n    (weeks0Count + weeksPassed1Count) * thisLessons2.filter(l => l.type === 0).length\n\n  stats.pr.pass =\n    weeksPassed0Count * thisLessons0.filter(l => l.type === 1).length +\n    weeksPassed1Count * thisLessons1.filter(l => l.type === 1).length +\n    (weeksPassed0Count + weeksPassed1Count) * thisLessons2.filter(l => l.type === 1).length\n\n  stats.lab.pass =\n    weeksPassed0Count * thisLessons0.filter(l => l.type === 2).length +\n    weeksPassed1Count * thisLessons1.filter(l => l.type === 2).length +\n    (weeksPassed0Count + weeksPassed1Count) * thisLessons2.filter(l => l.type === 2).length\n\n\n  const currentWeek = weeks[currentWeekIdx]\n  if(currentWeek)\n  {\n    const d = now.getDay()\n    const currentDay = d === 0 ? 6 : d - 1\n    \n    const thisLessonsEarlier = thisLessons\n      .filter(lesson => {\n        if(lesson.week !== currentWeek.weekType && lesson.week !== 2) return false\n        if(lesson.day < currentDay) return true\n        if(lesson.day === currentDay)\n        {\n          const n = now.getTime()\n          const [start, end] = time\n  \n          const [startHours, startMinutes] = start.split(':').map(s=>+s)\n          const s = new Date(n).setHours(startHours, startMinutes)\n          if(s > n) return false\n  \n          const [endHours, endMinutes] = end.split(':').map(s=>+s)\n          const e = new Date(n).setHours(endHours, endMinutes)\n          if(n > e) return false\n  \n          return true\n        }\n        return false\n      })\n  \n    thisLessonsEarlier.forEach(lesson => {\n      const typeLesson = (['lec','pr','lab'][lesson.type]) as keyof Stats\n      stats[typeLesson].pass++\n    })\n  }\n\n  const fromWhoms = getFromWhomsList(thisLessons)\n\n  return { stats, fromWhoms }\n}\n\nexport const isCurrentLesson = (lessonTime: number[][]): boolean => {\n  const TEN_MINUTES = 10 * 60 * 1000\n  const now = new Date().getTime()\n\n  const [start, end] = lessonTime\n  \n  const [startHours, startMinutes] = start\n  const lessonStart = new Date().setHours(startHours, startMinutes) - TEN_MINUTES\n  if(lessonStart > now) return false\n\n  const [endHours, endMinutes] = end\n  const lessonEnd = new Date().setHours(endHours, endMinutes)\n  if(lessonEnd < now) return false\n\n  return true\n}","import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport api from \"../../api\";\nimport { DayRange, Univer, WeekRange, WeekTypeRange } from \"../../types\";\nimport { getCurrentDay, getCurrentWeek, getDaysStats } from \"../../utils\";\n\ntype ConfigState = {\n  isLoading: boolean\n  error: {\n    message: string\n    payload: any\n  } | null\n  univerList: Univer[]\n  currentUniver: Univer | null\n  \n  passDays: number\n  countDays: number\n  toEndDays: number\n  toEndPercent: number\n  currentDay: DayRange\n  currentWeek: WeekRange\n  config: { [key:string]: boolean }\n}\n\nconst initialState: ConfigState = {\n  isLoading: false,\n  error: null,\n  univerList: [],\n  currentUniver: null,\n\n  passDays: 0,\n  countDays: 0,\n  toEndDays: 0,\n  toEndPercent: 0,\n  currentDay: 0,\n  currentWeek: 0,\n  config: {}\n}\n\nexport const requestConfigUnivers = createAsyncThunk(\n  'config/univers',\n  api.config.getUniverList\n)\n\nconst configSlice = createSlice({\n  name: 'config',\n  initialState,\n  reducers: {\n    setCurrentUniver(state, action)\n    {\n      let currentUniver = action.payload\n      if(!currentUniver)\n      {\n        state.currentUniver = null\n        return\n      }\n      \n      currentUniver = state.univerList.find(univer => univer.id === currentUniver.id)\n      state.currentUniver = currentUniver\n      state.currentDay = getCurrentDay()\n      state.currentWeek = getCurrentWeek(currentUniver.weeks)\n\n      const { passDays, countDays, toEndDays } = getDaysStats(\n        currentUniver.startDate,\n        currentUniver.endDate,\n      )\n      state.countDays = countDays\n      state.passDays = passDays\n      state.toEndDays = toEndDays\n      state.toEndPercent = passDays / countDays * 100\n    },\n    setConfig(state,action)\n    {\n      state.config = action.payload\n    },\n  },\n  extraReducers(builder)\n  {\n    builder\n      .addCase(requestConfigUnivers.pending, (state) => {\n        state.isLoading = true\n        state.error = null\n      })\n      .addCase(requestConfigUnivers.rejected, (state,action) => {\n        state.isLoading = false\n        state.error = {\n          message: 'Ошибка при запросе университетов :(',\n          payload: action.meta.arg\n        }\n      })\n      .addCase(requestConfigUnivers.fulfilled, (state,action) => {\n        state.isLoading = false\n        state.error = null\n        state.univerList = action.payload\n      })\n  },\n})\n\nexport const { setCurrentUniver, setConfig } = configSlice.actions\nexport default configSlice.reducer","import { createAsyncThunk, createSlice } from \"@reduxjs/toolkit\";\nimport api from \"../../api\";\nimport { User, UserData } from \"../../types\";\n\ntype ConfigState = {\n  isLoading: boolean\n  isUniverLoading: boolean\n  isScheduleLoading: boolean\n  error: {\n    message: string\n    payload: any\n  } | null\n  user: User | null\n  userData: UserData | null\n  isLoaderShowing: boolean\n}\n\nconst initialState: ConfigState = {\n  isLoading: false,\n  isLoaderShowing: true,\n  isUniverLoading: false,\n  isScheduleLoading: false,\n  error: null,\n  user: null,\n  userData: null,\n}\n\nexport const requestGetUser = createAsyncThunk(\n  'user/request',\n  api.user.getUser\n)\n\nexport const requestUpdateUserUniver = createAsyncThunk(\n  'user/update/univer',\n  api.user.updateUserUniver\n)\n\nexport const requestDeleteUserUniver = createAsyncThunk(\n  'user/delete/univer',\n  api.user.deleteUserUniver\n)\n\nexport const requestUpdateUserSchedule = createAsyncThunk(\n  'user/update/schedule',\n  api.user.updateUserSchedule\n)\n\nexport const requestDeleteUserSchedule = createAsyncThunk(\n  'user/delete/schedule',\n  api.user.deleteUserSchedule\n)\n\nconst userSlice = createSlice({\n  name: 'user',\n  initialState,\n  reducers: {\n    setUserData(state, action)\n    {\n      state.userData = action.payload\n    },\n    setIsLoaderShowing(state, action)\n    {\n      state.isLoaderShowing = action.payload\n    },\n  },\n  extraReducers(builder)\n  {\n    builder\n      .addCase(requestGetUser.pending, (state) => {\n        state.isLoading = true\n        state.error = null\n      })\n      .addCase(requestGetUser.rejected, (state,action) => {\n        state.isLoading = false\n        state.error = {\n          message: 'Произошла ошибка :(',\n          payload: action.meta.arg\n        }\n      })\n      .addCase(requestGetUser.fulfilled, (state,action) => {\n        state.isLoading = false\n        state.error = null        \n        state.user = action.payload\n      })\n\n      .addCase(requestUpdateUserUniver.pending, (state) => {\n        state.isUniverLoading = true\n        state.error = null\n      })\n      .addCase(requestUpdateUserUniver.rejected, (state,action) => {\n        state.isUniverLoading = false\n        state.error = {\n          message: 'При обновлении университета произошла ошибка :(',\n          payload: action.meta.arg\n        }\n      })\n      .addCase(requestUpdateUserUniver.fulfilled, (state,action) => {\n        state.isUniverLoading = false\n        state.error = null        \n        state.user = action.payload\n      })\n\n      .addCase(requestDeleteUserUniver.pending, (state) => {\n        state.isUniverLoading = true\n        state.error = null\n      })\n      .addCase(requestDeleteUserUniver.rejected, (state,action) => {\n        state.isUniverLoading = false\n        state.error = {\n          message: 'При обновлении университета произошла ошибка :(',\n          payload: action.meta.arg\n        }\n      })\n      .addCase(requestDeleteUserUniver.fulfilled, (state,action) => {\n        state.isUniverLoading = false\n        state.error = null        \n        state.user = action.payload\n      })\n\n      .addCase(requestUpdateUserSchedule.pending, (state) => {\n        state.isScheduleLoading = true\n        state.error = null\n      })\n      .addCase(requestUpdateUserSchedule.rejected, (state,action) => {\n        state.isScheduleLoading = false\n        state.error = {\n          message: 'При обновлении расписания произошла ошибка :(',\n          payload: action.meta.arg\n        }\n      })\n      .addCase(requestUpdateUserSchedule.fulfilled, (state,action) => {\n        state.isScheduleLoading = false\n        state.error = null        \n        state.user = action.payload\n      })\n\n      .addCase(requestDeleteUserSchedule.pending, (state) => {\n        state.isScheduleLoading = true\n        state.error = null\n      })\n      .addCase(requestDeleteUserSchedule.rejected, (state,action) => {\n        state.isScheduleLoading = false\n        state.error = {\n          message: 'При обновлении расписания произошла ошибка :(',\n          payload: action.meta.arg\n        }\n      })\n      .addCase(requestDeleteUserSchedule.fulfilled, (state,action) => {\n        state.isScheduleLoading = false\n        state.error = null        \n        state.user = action.payload\n      })\n  },\n})\n\nexport const { setUserData, setIsLoaderShowing } = userSlice.actions\nexport default userSlice.reducer","import { combineReducers } from \"@reduxjs/toolkit\"\n\nimport navigation from './slices/navigation'\nimport schedule from './slices/schedule'\nimport config from './slices/config'\nimport user from './slices/user'\n\nconst rootReducer = combineReducers({\n  navigation,\n  schedule,\n  config,\n  user,\n})\n\nexport type RootState = ReturnType<typeof rootReducer>\nexport default rootReducer","import { configureStore } from \"@reduxjs/toolkit\"\nimport { useDispatch } from \"react-redux\"\n\nimport rootReducer from './rootReducer'\n\nconst store = configureStore({ reducer : rootReducer })\n\nexport const useAppDispatch = () => useDispatch<typeof store.dispatch>()\nexport default store","import React from 'react'\nimport { Lesson } from '../../types'\nimport './LessonRow.sass'\n\ntype LessonRowProps = {\n  current: boolean\n  lesson: Lesson\n  onGoToSchedule: (href: string) => void\n  getStats?: () => void\n}\n\nconst LessonRow: React.FC<LessonRowProps> = ({\n  current,\n  lesson,\n  onGoToSchedule,\n  getStats,\n}) => {\n  return (\n    <div className={`lesson-row${current ? ' lesson-row--current' : ''}`}>\n      <div className=\"lesson-row__time\">\n        {lesson.time.map((time, i) => {\n          return <div\n            key={time}\n            className={`lesson-row__time-item lesson-row__time-item--${i === 0 ? 'start' : 'end'}`}\n          >{time}</div>\n        })}\n      </div>\n      <div className={`lesson-row__body lesson-row__body--${lesson.type}`}>\n        {lesson.typeTitle &&\n          <div className=\"lesson-row__place\">\n            <span className={`lesson-row__type-title--${lesson.type}`}>\n              {lesson.typeTitle}\n            </span>\n            {lesson.place}\n          </div>\n        }\n        <div onClick={() => getStats && getStats()} className=\"lesson-row__subject\">\n          {lesson.subject} {lesson.group !== 2 && `(${lesson.group+1}гр.)`}\n        </div>\n        <div className=\"lesson-row__fromWhoms\">\n          {lesson.fromWhoms.map(fromWhom => {\n            return <div\n              key={fromWhom.href}\n              className={`lesson-row__fromWhoms-item${!fromWhom.href ? '' : ' link'}`}\n              onClick={() => fromWhom.href && onGoToSchedule(fromWhom.href)}\n            >{fromWhom.title}</div>\n          })}\n        </div>\n      </div>\n      <div className=\"lesson-row__after\"></div>\n    </div>\n  )\n}\n\nexport default LessonRow","import React from 'react'\nimport { Icon56GhostOutline } from '@vkontakte/icons'\nimport { Card, Placeholder } from '@vkontakte/vkui'\nimport { Lesson } from '../../types'\nimport LessonRow from '../LessonRow'\nimport { isCurrentLesson } from '../../utils'\n\ntype ScheduleBodyProps = {\n  today: boolean\n  lessons: Lesson[]\n  onGoToSchedule: (href: string) => void\n  onGetStats?: (lesson: Lesson) => void\n}\n\nconst ScheduleBody: React.FC<ScheduleBodyProps> = ({\n  today,\n  lessons,\n  onGoToSchedule,\n  onGetStats,\n}) => {\n  return (\n    <Card className=\"schedule__body\">\n      {lessons.length === 0\n        ? <Placeholder\n            className=\"schedule__empty-placeholder\"\n            icon={<Icon56GhostOutline style={{color:\"teal\"}}/>}\n          >Ничего нет</Placeholder>\n        : lessons.map((lesson, j) => {\n            const lessonTime = lesson.time.map(timeString => timeString.split(':').map(s=>+s))\n            const current = today && isCurrentLesson(lessonTime)\n\n            return <LessonRow\n              key={j}\n              lesson={lesson}\n              onGoToSchedule={onGoToSchedule}\n              current={current}\n              getStats={() => onGetStats && onGetStats(lesson)}\n            />\n          })}\n    </Card>\n  )\n}\n\nexport default ScheduleBody","import React from 'react'\nimport {\n  Avatar,\n  Button,\n  Card,\n  Cell,\n  CellButton,\n  Div,\n  Header,\n  IconButton,\n  Panel,\n  PanelHeader,\n  Placeholder,\n  Progress,\n  Separator,\n  Spinner,\n} from '@vkontakte/vkui'\nimport {\n  Icon28Search,\n  Icon28SettingsOutline,\n  Icon28ChevronDownOutline,\n  Icon28ChevronUpOutline,\n  Icon28DeleteOutline,\n  Icon28AddOutline,\n  Icon28EducationOutline,\n  Icon28ArrowUpOutline,\n  Icon28ArrowDownOutline,\n  \n} from '@vkontakte/icons';\nimport { PanelProps } from '../../types'\nimport { useSelector } from 'react-redux';\nimport { setActivePanel } from '../../store/slices/navigation';\nimport { SCHEDULE_PANEL, SEARCH_PANEL, SETTINGS_PANEL } from '../../constants';\nimport { requestDeleteUserSchedule, requestGetUser, setIsLoaderShowing } from '../../store/slices/user';\nimport { requestConfigUnivers } from '../../store/slices/config';\nimport { RootState } from '../../store/rootReducer';\nimport { getFromWhomsList, getLessonsInDay, isCurrentWeek, isPassWeek } from '../../utils';\nimport { requestSchedule } from '../../store/slices/schedule';\nimport ScheduleBody from '../../components/ScheduleBody';\nimport { useAppDispatch } from '../../store';\nimport Qoute from '../../components/Qoute';\nimport Loader from '../../components/Loader';\n\nconst MainPanel: React.FC<PanelProps> = ({\n  id,\n}) => {\n  const dispatch = useAppDispatch()\n  const {\n    isLoaderShowing,\n    user,\n    isLoading: isUserLoading,\n    error: userError,\n  } = useSelector((s: RootState) => s.user)\n  const {\n    currentUniver,\n    currentWeek,\n    currentDay,\n    toEndDays,\n    toEndPercent,\n    isLoading: isConfigLoading,\n    error: configError,\n  } = useSelector((s: RootState) => s.config)\n\n  const goToSearchSchedule = () => {\n    dispatch(setActivePanel(SEARCH_PANEL))\n  }\n\n  const goToSettings = () => {\n    dispatch(setActivePanel(SETTINGS_PANEL))\n  }\n\n  const goToSchedule = (tail: string) => {\n    dispatch(requestSchedule({\n      univer: user!.univer!.code,\n      tail,\n    }))\n    dispatch(setActivePanel(SCHEDULE_PANEL))\n  }\n\n  const deleteSchedule = () => {\n    dispatch(requestDeleteUserSchedule(user!.id))\n  }\n\n  const tryAgain = () => {\n    if(userError && user)\n    {\n      dispatch(requestGetUser(user.id))\n    }\n    if(configError)\n    {\n      dispatch(requestConfigUnivers())\n    }\n  }\n\n  const [fromWhomsIsOpen, setFromWhomsIsOpen] = React.useState(false)\n  const toggleFromWhoms = () => {\n    setFromWhomsIsOpen(!fromWhomsIsOpen)\n  }\n\n  const [weeksIsOpen, setWeeksIsOpen] = React.useState(false)\n  const toggleWeeks = () => {\n    setWeeksIsOpen(!weeksIsOpen)\n  }\n\n  const [timeLessonsIsOpen, setTimeLessonsIsOpen] = React.useState(false)\n  const toggleTimeLessons = () => {\n    setTimeLessonsIsOpen(!timeLessonsIsOpen)\n  }\n  \n  const hideLoader = () => {\n    dispatch(setIsLoaderShowing(false))\n  }\n\n  let content\n  if(isUserLoading || isConfigLoading)// || isLoaderShowing)\n  {\n    // content = <Loader isEnd={!isUserLoading && !isConfigLoading} onHide={hideLoader} />\n    content = <Spinner style={{paddingTop:'20vh'}} />\n  }\n  else if(userError || configError)\n  {\n    const userMessage = userError && userError.message\n    const configMessage = configError && configError.message\n\n    content = (\n      <Placeholder\n        stretched\n        action={\n          <Button onClick={tryAgain}>Повторить</Button>\n        }\n      >{userMessage}<br/>{configMessage}</Placeholder>\n    )\n  }\n  else if(user)\n  {\n    let univerContent\n    if(user.univer && currentUniver)\n    {\n      univerContent = (<>\n        {/* <Qoute photo=\"\" name=\"Величайший\">Силен не тот, а этот</Qoute> */}\n        {/* <Separator/> */}\n\n        <Div>\n          <Card>\n            <Header\n              subtitle={`До конца семестра ${toEndDays} дн. (${new Date(currentUniver.endDate).toLocaleDateString()})`}\n            >{currentWeek ? 'Числитель' : 'Знаменатель'}</Header>\n            <Progress\n              style={{margin: '0px 12px', background: 'gray'}}\n              value={toEndPercent}\n            />\n            <br />\n            <Separator />\n\n            <Cell\n              after={<Icon28Search/>}\n              onClick={goToSearchSchedule}\n            >Искать расписание</Cell>\n          </Card>\n        </Div>\n      </>)\n    }\n\n    if(!user.univer)\n    {\n      univerContent = (\n        <Placeholder\n          stretched\n          icon={<Icon28EducationOutline width={64} height={64}/>}\n          action={<Button onClick={goToSettings}>Выбрать</Button>}\n        >Выберите университет, чтобы пользоваться приложением</Placeholder>\n      )\n    }\n\n    let scheduleContent\n    if(user.schedule)\n    {\n      const lessonsToday = getLessonsInDay(user.schedule.lessons, currentDay, currentWeek)\n      const DAYS = ['Понедельник','Вторник','Среда','Четверг','Пятница','Суббота']\n      const todayString = `${DAYS[currentDay]}, ${new Date().toLocaleDateString()}`\n\n      scheduleContent = (<>\n        <Div style={{paddingTop:0}}>\n          <Card>\n            <Cell\n              disabled\n              after={\n                <IconButton>\n                  <Icon28DeleteOutline fill=\"tomato\" onClick={deleteSchedule}/>\n                </IconButton>\n              }\n            >{user.schedule.title}</Cell>\n            <Separator/>\n\n            <Header subtitle={todayString}>\n              Расписание на сегодня\n            </Header>\n            <div style={{padding:'0px 8px'}}>\n              <ScheduleBody today lessons={lessonsToday} onGoToSchedule={goToSchedule} />\n            </div>\n            <br/><Separator/>\n            \n            <CellButton\n              onClick={() => goToSchedule(user.schedule!.href)}\n            >Полное расписание</CellButton>\n          </Card>\n        </Div>\n        <Div style={{paddingTop:0}}>\n          <Card>\n            <Cell\n              onClick={toggleFromWhoms}\n              after={!fromWhomsIsOpen ? <Icon28ChevronDownOutline /> : <Icon28ChevronUpOutline/>}\n            >Преподаватели/Группы</Cell>\n            {fromWhomsIsOpen && getFromWhomsList(user.schedule.lessons).map(fromWhom => {\n              return <CellButton\n                key={fromWhom.href}\n                onClick={() => goToSchedule(fromWhom.href)}\n              >{fromWhom.title}</CellButton>\n            })}\n          </Card>\n        </Div>\n      </>)\n    }\n    \n    if(user.univer && !user.schedule)\n    {\n      scheduleContent = (\n        <Div style={{paddingTop:0}}>\n          <Card>\n            <Cell\n              after={<Icon28AddOutline fill=\"orange\"/>}\n              onClick={goToSearchSchedule}\n            >Расписание не выбрано</Cell>\n          </Card>\n        </Div>\n      )\n    }\n\n    let univerInfoContent\n    if(currentUniver)\n    {\n      univerInfoContent = (<>\n        <Separator/>\n        <Div>\n          <Card>\n            <Cell\n              onClick={toggleWeeks}\n              after={!weeksIsOpen ? <Icon28ChevronDownOutline /> : <Icon28ChevronUpOutline/>}\n            >Учебные недели</Cell>\n            {weeksIsOpen && <Separator/>}\n            {weeksIsOpen && currentUniver.weeks.map((week, i) => {\n              const startRangString = new Date(week.range[0]).toLocaleDateString()\n              const endRangeString = new Date(week.range[1]).toLocaleDateString()\n              const rangeString = startRangString + ' - ' + endRangeString\n              \n              const weekPassed = isPassWeek(week.range[1])\n\n              return <Cell\n                key={i}\n                disabled\n                description={rangeString}\n                after={\n                  week.weekType === 0\n                    ? <Icon28ArrowUpOutline fill={isCurrentWeek(week) ? 'tomato' : 'teal'}/>\n                    : <Icon28ArrowDownOutline fill={isCurrentWeek(week) ? 'tomato' : 'violet'}/>\n                }\n              >\n                <span style={{\n                  textDecoration: weekPassed ? 'line-through': 'none',\n                  opacity: weekPassed ? 0.5 : 1,\n                  color: isCurrentWeek(week) ? 'tomato' : '',\n                }}>\n                  {week.weekType === 0?'Числитель':'Знаменатель'}\n                </span>\n              </Cell>\n            })}\n          </Card>\n        </Div>\n        <Div style={{paddingTop:0}}>\n          <Card>\n            <Cell\n              onClick={toggleTimeLessons}\n              after={!timeLessonsIsOpen ? <Icon28ChevronDownOutline /> : <Icon28ChevronUpOutline/>}\n            >Время занятий</Cell>\n            {timeLessonsIsOpen && <Separator/>}\n            {timeLessonsIsOpen && currentUniver.timeLessons.map((time, i) => {\n              return <Cell\n                key={i}\n                disabled\n                description={`${i+1} пара`}\n              >{time}</Cell>\n            })}\n          </Card>\n        </Div>\n      </>)\n    }\n\n    content = (<>\n      {univerContent}\n      {scheduleContent}\n      {univerInfoContent}\n    </>)\n  }\n\n  return (\n    <Panel id={id}>\n      <PanelHeader\n        separator={false}\n        // left={!(isUserLoading || isConfigLoading || isLoaderShowing) && user?.univer && <Icon28SettingsOutline onClick={goToSettings}/>}\n        left={!(isUserLoading || isConfigLoading) && user?.univer && <Icon28SettingsOutline onClick={goToSettings}/>}\n      />\n      {content}\n    </Panel>\n  )\n}\n\nexport default MainPanel","import React from 'react'\nimport {\n  ActionSheet,\n  ActionSheetItem,\n  Button,\n  Card,\n  Div,\n  Gallery,\n  IconButton,\n  Link,\n  Panel,\n  PanelHeader,\n  Placeholder,\n  SimpleCell,\n  Spinner,\n  Tabs,\n  TabsItem,\n} from '@vkontakte/vkui'\nimport {\n  Icon28ArrowUturnLeftOutline,\n  Icon28HomeOutline,\n  Icon28MoreVertical,\n  Icon28DeleteOutline,\n  Icon28SortHorizontalOutline,\n  Icon28Users3Outline,\n  Icon28FavoriteCircleFillYellow,\n} from '@vkontakte/icons';\nimport { useDispatch, useSelector } from 'react-redux'\nimport { RootState } from '../../store/rootReducer'\nimport { DayRange, Lesson, PanelProps, WeekRange } from '../../types'\nimport { getDiff, getLessonsInDay, getStatsForLesson } from '../../utils'\nimport { clearScheduleHistory, requestSchedule, scheduleHistoryBack, setLessonStats } from '../../store/slices/schedule';\nimport { setActiveModal, setActivePanel } from '../../store/slices/navigation';\nimport { MAIN_PANEL } from '../../constants';\nimport { requestDeleteUserSchedule, requestUpdateUserSchedule } from '../../store/slices/user';\nimport ScheduleBody from '../../components/ScheduleBody';\nimport './Schedule.sass'\n\nconst DAYS = [\n  { id: 0, title: 'ПН' },\n  { id: 1, title: 'ВТ' },\n  { id: 2, title: 'СР' },\n  { id: 3, title: 'ЧТ' },\n  { id: 4, title: 'ПТ' },\n  { id: 5, title: 'СБ' },\n]\nconst WEEKS = [\n  { id: 0, title: 'Числитель'},\n  { id: 1, title: 'Знаменатель'},\n]\n\nconst SchedulePanel: React.FC<PanelProps> = ({\n  id,\n  setPopout,\n}) => {\n  const dispatch = useDispatch()\n  const { isLoading, error, schedule, scheduleHistoryHrefs, } = useSelector((s: RootState) => s.schedule)\n  const { user } = useSelector((s: RootState) => s.user)\n  const { currentUniver, currentDay, currentWeek } = useSelector((s: RootState) => s.config)\n\n  const [activeDay, setActiveDay] = React.useState<DayRange>(currentDay)\n  const [activeWeek, setActiveWeek] = React.useState<WeekRange>(currentWeek)\n\n  const [isDiffShowing, setIsDiffShowing] = React.useState(false)\n  const toggleDiffShowing = () => {\n    setIsDiffShowing(!isDiffShowing)\n  }\n\n  const goToMain = () => {\n    dispatch(setActivePanel(MAIN_PANEL))\n    dispatch(clearScheduleHistory())\n  }\n\n  const goBack = () => {\n    if(scheduleHistoryHrefs.length === 1)\n    {\n      goToMain()\n    }\n    else\n    {\n      dispatch(scheduleHistoryBack())\n      setIsDiffShowing(false)\n    }\n  }\n\n  const saveSchedule = () => {\n    setIsDiffShowing(false)\n    dispatch(requestUpdateUserSchedule({\n      id: user!.id,\n      scheduleId: schedule!.href,\n    }))\n  }\n\n  const deleteSchedule = () => {\n    setIsDiffShowing(false)\n    dispatch(requestDeleteUserSchedule(user!.id))\n  }\n\n  const showActions = () => {\n    let toggleScheduleItem =\n      user!.schedule && user!.schedule.href === schedule!.href\n        ? <ActionSheetItem\n            autoclose\n            style={{color: 'tomato'}}\n            onClick={deleteSchedule}\n            before={<Icon28DeleteOutline fill=\"tomato\"/>}\n          >Удалить расписание</ActionSheetItem>\n        : <ActionSheetItem\n            autoclose\n            onClick={saveSchedule}\n            before={<Icon28FavoriteCircleFillYellow/>}\n            subtitle={user!.schedule?'вместо текущего':''}\n          >Сохранить расписание</ActionSheetItem>\n\n    const popout = (\n      <ActionSheet\n        onClose={() => setPopout!(null)}\n        iosCloseItem={\n          <ActionSheetItem autoclose mode=\"cancel\">\n            Отменить\n          </ActionSheetItem>\n        }\n      >\n        {false &&\n          <ActionSheetItem\n            autoclose\n            style={{color:'tan'}}\n            before={<Icon28Users3Outline fill=\"tan\"/>}\n            onClick={()=>{}}\n          >Экзамены</ActionSheetItem>\n        }\n        {user!.schedule && !(user!.schedule.href === schedule!.href) &&\n          <ActionSheetItem\n            autoclose\n            style={{color:'teal'}}\n            before={\n              <Icon28SortHorizontalOutline\n                fill={isDiffShowing?'tomato':'orange'}\n                style={{transform:`rotateY(${isDiffShowing?0:180}deg)`}}\n              />\n            }\n            subtitle={\n              isDiffShowing\n                ? 'Все занятия данного расписания'\n                : 'Занятия вне вашего расписания'\n              }\n            onClick={toggleDiffShowing}\n          >\n            {isDiffShowing ? 'Расписание без разницы' : 'Разница расписаний'}\n          </ActionSheetItem>\n        }\n        {toggleScheduleItem}\n      </ActionSheet>\n    )\n    setPopout!(popout)\n  }\n\n  const goToSchedule = (tail: string) => {\n    dispatch(requestSchedule({\n      univer: user!.univer!.code,\n      tail,\n    }))\n    setIsDiffShowing(false)\n  }\n\n  const cardRef = React.useRef<HTMLDivElement>(null)\n\n  let content\n  if(isLoading)\n  {\n    content = <Spinner />\n  }\n  else if(error)\n  {\n    content = <Placeholder\n      stretched\n      action={\n        <Button onClick={() => {\n          dispatch(requestSchedule(error.payload))\n        }}>Повторить</Button>}\n    >{error.message}</Placeholder>\n  }\n  else if(schedule)\n  {\n    const ls = isDiffShowing ? getDiff(schedule.lessons, user!.schedule!.lessons) : schedule.lessons\n\n    content = ( <>      \n      <div className=\"schedule__card\" ref={cardRef}>\n        <Gallery\n          style={{height:'100%'}}\n          slideIndex={activeDay}\n          onChange={d => setActiveDay(d as DayRange)}\n        >\n          {DAYS.map((_,i) => {\n            const lessons = getLessonsInDay(ls, i as DayRange, activeWeek)\n\n            return <ScheduleBody\n              key={i}\n              today={activeDay === currentDay && activeWeek === currentWeek}\n              lessons={lessons}\n              onGoToSchedule={goToSchedule}\n              onGetStats={(lesson: Lesson) => {\n                const { stats, fromWhoms } = getStatsForLesson({\n                  lesson,\n                  lessons: schedule.lessons,\n                  currentUniver: currentUniver!,\n                })\n                dispatch(setLessonStats({\n                  title: lesson.subject,\n                  stats,\n                  fromWhoms,\n                }))\n                dispatch(setActiveModal('stats'))\n              }}\n            />\n          })}\n        </Gallery>\n      </div>\n\n      <Card style={{marginTop:8}}>\n        <Tabs>\n          {WEEKS.map(week => {\n            return <TabsItem\n              key={week.id}\n              selected={week.id === activeWeek}\n              onClick={() => setActiveWeek(week.id as WeekRange)}\n              style={{color: currentWeek === week.id ? 'tomato': ''}}\n            >{week.title}</TabsItem>\n          })}\n        </Tabs>\n        <Tabs>\n          {DAYS.map(day => {\n            return <TabsItem\n              key={day.id}\n              selected={day.id === activeDay}\n              onClick={() => setActiveDay(day.id as DayRange)}\n              style={{color: currentDay === day.id ? 'tomato': ''}}\n            >{day.title}</TabsItem>\n          })}\n        </Tabs>\n        <SimpleCell\n          disabled\n          before={\n            <IconButton>\n              <Icon28ArrowUturnLeftOutline onClick={goBack} width={20} style={{marginRight: 12, color:'teal'}}/>\n            </IconButton>\n          }\n          after={\n            <IconButton>\n              <Icon28MoreVertical onClick={showActions} width={20} style={{color:'violet'}}/>\n            </IconButton>\n          }\n        >\n          <Link href={`${user!.univer!.baseUrl}${schedule.href}`}>\n            {schedule.title}\n          </Link>\n          {isDiffShowing &&\n            <Icon28SortHorizontalOutline className=\"schedule__icon--diff\"/>\n          }\n          {user?.schedule && user.schedule.href === schedule.href &&\n            <Icon28FavoriteCircleFillYellow className=\"schedule__icon--fav\"/>\n          }\n        </SimpleCell>\n      </Card>\n    </>)\n  }\n\n  return (\n    <Panel id={id}>\n      <PanelHeader\n        separator={false}\n        left={\n          <Icon28HomeOutline onClick={goToMain} />\n        }\n      />\n      <Div className=\"schedule__wrapper\">\n        {content}\n      </Div>\n    </Panel>\n  )\n}\n\nexport default SchedulePanel","import React, { ChangeEvent } from 'react'\nimport {\n  CellButton,\n  Div,\n  FixedLayout,\n  Panel,\n  PanelHeader,\n  PanelHeaderBack,\n  Placeholder,\n  Search,\n  Spinner,\n} from '@vkontakte/vkui'\nimport { Icon56GhostOutline } from '@vkontakte/icons'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { MAIN_PANEL, SCHEDULE_PANEL } from '../../constants'\nimport { RootState } from '../../store/rootReducer'\nimport { setActivePanel } from '../../store/slices/navigation'\nimport { clearSearchedSchedules, requestSchedule, requestSearchSchedule } from '../../store/slices/schedule'\nimport { HrefTitle, PanelProps } from '../../types'\n\nconst SearchPanel: React.FC<PanelProps> = ({\n  id,\n}) => {\n  const dispatch = useDispatch()\n  const { isSearchLoading, searchedSchedules, } = useSelector((s: RootState) => s.schedule)\n  const { user } = useSelector((s: RootState) => s.user)\n\n  const [q, setQ] = React.useState<string>('')\n  const handleQChange = (e: ChangeEvent<HTMLInputElement>) => {\n    const q = e.target.value\n\n    setQ(q)\n    if(!q)\n    {\n      dispatch(clearSearchedSchedules())\n    }\n  }\n\n  const searchRef = React.useRef<HTMLInputElement>(null)\n  React.useEffect(() => {\n    window.setTimeout(() => {\n      searchRef.current && searchRef.current.focus()\n    },100)\n    return () => {\n      dispatch(clearSearchedSchedules())\n    }\n  },[])\n\n  const [debQ, setDebQ] = React.useState(q)\n  React.useEffect(() => {\n    const timeout = window.setTimeout(() => {\n      setDebQ(q)\n    }, 300)\n\n    return () => {\n      window.clearTimeout(timeout)\n    }\n  }, [q])\n\n  React.useEffect(() => {\n    if(debQ)\n    {\n      dispatch(requestSearchSchedule({\n        univer: user!.univer!.code,\n        q: debQ,\n      }))\n    }\n  }, [debQ])\n\n  const goToMainPanel = () => {\n    dispatch(setActivePanel(MAIN_PANEL))\n  }\n\n  const goToSchedule = (schedule: HrefTitle) => {\n    dispatch(requestSchedule({\n      univer: user!.univer!.code,\n      tail: schedule.href,\n    }))\n    dispatch(setActivePanel(SCHEDULE_PANEL))\n  }\n\n  let content\n\n  if(isSearchLoading)\n  {\n    content = <Spinner />\n  }\n  else if(searchedSchedules.length === 0)\n  {\n    content = <Placeholder\n      icon={<Icon56GhostOutline style={{color:\"teal\"}} />}\n    >Ничего не найдено</Placeholder>\n  }\n  else\n  {\n    content = (<>\n      {searchedSchedules.map((schedule, i) => {\n        return <CellButton\n          key={i}\n          onClick={() => goToSchedule(schedule)}\n        >{schedule.title}</CellButton>\n      })}\n      <div style={{textAlign:'center'}}>\n        Уточните или исправьте запрос, если не нашли нужное расписание\n      </div>\n    </>)\n  }\n\n  return (\n    <Panel id={id}>\n      <PanelHeader\n        separator={false}\n        left={\n          <PanelHeaderBack onClick={goToMainPanel} />\n        }\n      >Поиск</PanelHeader>\n\n      <FixedLayout style={{paddingTop:24}} vertical=\"top\" filled>\n        <Search\n          getRef={searchRef}\n          placeholder=\"Поиск расписания\"\n          after={null}\n          value={q}\n          onChange={handleQChange}\n        />\n      </FixedLayout>\n\n      <Div style={{marginTop:70}}>{content}</Div>\n    </Panel>\n  )\n}\n\nexport default SearchPanel","import React, { ChangeEvent } from 'react'\nimport {\n  Button,\n  Div,\n  FormItem,\n  Group,\n  Header,\n  NativeSelect,\n  Panel,\n  PanelHeader,\n  PanelHeaderBack,\n} from '@vkontakte/vkui'\nimport { PanelProps } from '../../types'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { setActivePanel } from '../../store/slices/navigation'\nimport { MAIN_PANEL } from '../../constants'\nimport { RootState } from '../../store/rootReducer'\nimport { requestDeleteUserUniver, requestUpdateUserUniver } from '../../store/slices/user'\n\nconst SettingsPanel: React.FC<PanelProps> = ({\n  id,\n}) => {\n  const dispatch = useDispatch()\n  const { univerList } = useSelector((s: RootState) => s.config)\n  const { user } = useSelector((s: RootState) => s.user)\n\n  const goToMain = () => {\n    dispatch(setActivePanel(MAIN_PANEL))\n  }\n\n  const userUniverId = user?.univer?.id ?? ''\n  const [univer, setUniver] = React.useState(''+userUniverId)\n  const handleChangeUniver = (e: ChangeEvent<HTMLSelectElement>) => {\n    setUniver(e.target.value)\n  }\n\n  const changeUniver = () => {\n    if((''+userUniverId) !== univer)\n    {\n      if(univer === '')\n      {\n        dispatch(requestDeleteUserUniver(user!.id))\n      }\n      else\n      {\n        dispatch(requestUpdateUserUniver({\n          id: user!.id,\n          univerId: +univer,\n        }))\n      }\n    }\n  }\n\n  return (\n    <Panel id={id}>\n      <PanelHeader\n        separator={false}\n        left={<PanelHeaderBack onClick={goToMain} />}\n      >Настройки</PanelHeader>\n\n      <Group header={<Header mode=\"secondary\">Главное</Header>}>      \n        <FormItem\n          top=\"Университет\"\n          bottom=\"При изменении университета, выбранная группа удалится!\"\n          >\n          <NativeSelect\n            placeholder=\"Не выбран\"\n            value={univer}\n            onChange={handleChangeUniver}\n            >\n            {univerList.map(univer => {\n              return <option\n              key={univer.code}\n              value={univer.id}\n              >{univer.subtitle}</option>\n            })}\n          </NativeSelect>\n        </FormItem>\n        <Div style={{paddingTop:0}}>\n          <Button\n            disabled={(''+userUniverId) === univer}\n            style={{width:'100%'}}\n            size=\"l\"\n            onClick={changeUniver}\n            >Сохранить</Button>\n        </Div>\n      </Group>\n    </Panel>\n  )\n}\n\nexport default SettingsPanel","import React from \"react\"\nimport {\n  Cell,\n  IconButton,\n  usePlatform,\n} from \"@vkontakte/vkui\"\nimport {\n  Icon28FavoriteOutline,\n  Icon28ShareOutline,\n  Icon28SmartphoneOutline,\n  Icon28UsersOutline,\n} from \"@vkontakte/icons\"\nimport bridge from '@vkontakte/vk-bridge'\nimport './AppActions.sass'\nimport { GROUP_ID } from \"../../constants\"\n\ntype AppActionsProps = {\n  closeModal: () => void\n}\n\nconst AppActions: React.FC<AppActionsProps> = ({\n  closeModal,\n}) => {\n  const platform = usePlatform()\n\n  const addToFavorite = () => {\n    closeModal()\n    bridge.send('VKWebAppAddToFavorites')\n      .then(console.log)\n      .catch(console.log)\n  }\n\n  const joinToGroup = () => {\n    closeModal()\n    bridge.send('VKWebAppJoinGroup', { group_id: GROUP_ID })\n      .then(console.log)\n      .catch(console.log)\n  }\n\n  const addToHomeScreen = () => {\n    closeModal()\n    bridge.send('VKWebAppAddToHomeScreen')\n      .then(console.log)\n      .catch(console.log)\n  }\n\n  const share = () => {\n    closeModal()\n    bridge.send('VKWebAppShare', {link: 'https://vk.com/app7908078'})\n      .then(console.log)\n      .catch(console.log)\n  }\n\n  return (\n    <div>\n      {/* <Header>Не теряйте приложение</Header>\n      <Div className=\"actions-wrapper\" style={{paddingTop:0}}>\n        {true &&\n          <div className=\"actions__item\">\n            <IconButton>\n              <Icon28FavoriteOutline fill=\"orange\"/>\n            </IconButton>\n            Добавить в избранное\n          </div>\n        }\n        {true &&\n          <div className=\"actions__item\">\n            <IconButton>\n              <Icon28UsersOutline fill=\"var(--accent)\"/>\n            </IconButton>\n            Вступить в сообщество\n          </div>\n        }\n        {true &&\n          <div className=\"actions__item\">\n            <IconButton>\n              <Icon28ShareOutline fill=\"teal\"/>\n            </IconButton>\n            Поделиться приложением\n          </div>\n        }\n        {true &&\n          <div className=\"actions__item\">\n            <IconButton>\n              <Icon28SmartphoneOutline fill=\"tan\"/>\n            </IconButton>\n            На домашний экран\n          </div>\n        }\n      </Div> */}\n      {true &&\n        <Cell\n          before={\n            <IconButton>\n              <Icon28FavoriteOutline style={{marginRight:8,padding:0}} fill=\"orange\"/>\n            </IconButton>\n          }\n          description=\"Мини-приложения > Избранное\"\n          onClick={addToFavorite}\n        >В избранном</Cell>\n      }\n      {true &&\n        <Cell\n          before={\n            <IconButton>\n              <Icon28UsersOutline style={{marginRight:8,padding:0}} fill=\"var(--accent)\"/>\n            </IconButton>\n          }\n          description=\"Шапка группы\"\n          onClick={joinToGroup}\n        >Вступите в группу</Cell>\n      }\n      {platform === 'android' &&\n        <Cell\n          before={\n            <IconButton>\n                <Icon28SmartphoneOutline style={{marginRight:8,padding:0}} fill=\"tan\"/>\n              </IconButton>\n            }\n          description=\"Быстрый доступ с дом. экрана\"\n          onClick={addToHomeScreen}\n        >На домашний экран</Cell>\n      }\n      {true &&\n        <Cell\n          before={\n            <IconButton>\n              <Icon28ShareOutline style={{marginRight:8}} fill=\"teal\"/>\n            </IconButton>\n          }\n          description=\"Доступ по ссылке\"\n          onClick={share}\n        >Расскажите друзьям</Cell>\n      }\n    </div>\n  )\n}\n\nexport default AppActions","import React from \"react\"\nimport { Avatar, Caption, Card, CellButton, Div, Header, ModalCard, ModalPage, ModalPageHeader, ModalRoot, Progress } from \"@vkontakte/vkui\"\nimport AppActions from \"../AppActions\"\nimport { useDispatch, useSelector } from \"react-redux\"\nimport { RootState } from \"../../store/rootReducer\"\nimport { setActiveModal } from \"../../store/slices/navigation\"\nimport { Icon24Dismiss } from \"@vkontakte/icons\"\nimport './ActionsModal.sass'\nimport { requestSchedule } from \"../../store/slices/schedule\"\n\n\nconst ActionsModal = () => {\n  const dispatch = useDispatch()\n  const { activeModal } = useSelector((s: RootState) => s.navigation)\n  const { lessonStats } = useSelector((s: RootState) => s.schedule)\n  const { user } = useSelector((s: RootState) => s.user)\n  const { currentUniver } = useSelector((s: RootState) => s.config)\n  \n  const closeModal = () => {\n    dispatch(setActiveModal(null))\n  }\n\n  const goToSchedule = (tail: string) => {\n    dispatch(requestSchedule({\n      univer: user!.univer!.code,\n      tail,\n    }))\n    closeModal()\n  }\n\n  return (\n    <ModalRoot\n      activeModal={activeModal}\n      onClose={closeModal}\n    >\n      <ModalCard\n        id=\"actions\"\n        header=\"Не теряйте приложение\"\n        subheader=\"Т.к. приложение не находится в каталоге, найти через поиск его не получится. Поэтому, чтобы не потерять его, сохраните любым удомным способом:\"\n        icon={<Avatar size={72}/>}\n      >\n        <AppActions closeModal={closeModal}/>\n      </ModalCard>\n      <ModalPage id=\"stats\">\n        <ModalPageHeader\n          right={<Icon24Dismiss onClick={closeModal} style={{marginRight:8}}/>}\n        >Статистика</ModalPageHeader>\n        {lessonStats && <>\n          <Div>\n            <Card>\n              <Div>{lessonStats.title}</Div>\n            </Card>\n          </Div>\n          <Div style={{paddingTop:'0px 12px'}}>\n            {currentUniver &&\n              <Caption level=\"2\" weight=\"regular\" style={{opacity:0.5}}>\n                Пожалуйста, не воспринимайте данную статистику буквально!\n                Т.к. для расчета, первым днем принят {new Date(currentUniver.startDateStartOfWeek).toLocaleDateString()},\n                а последним {new Date(currentUniver.endDate).toLocaleDateString()}.\n              </Caption>\n            }\n          </Div>\n          <Div style={{padding:'0px 12px'}}>\n            {Object.entries(lessonStats.stats).map(([typeLesson, values]) => {\n              const { pass, total } = values\n              if(total === 0) return null\n              \n              const title = {\n                lec: 'Лекция',\n                pr: 'Практика',\n                lab: 'Лабораторная',\n              }[typeLesson]\n              \n              return (\n                <div className=\"stats__item\" key={typeLesson}>\n                  <Header>\n                    {title}\n                    <span className=\"stats__secondary\">{pass}/{total}</span>\n                  </Header>\n                  <Progress\n                    className={`stats__progress--${typeLesson}`}\n                    style={{margin: '0px 12px 8px 12px',}}\n                    value={pass / total * 100}\n                    />\n                </div>\n              )\n            })}\n          </Div>\n          <Div>\n            <Header>Преподаватели / группы</Header>\n            {lessonStats.fromWhoms.map(fromWhom => {\n              return <CellButton\n                key={fromWhom.href}\n                onClick={() => goToSchedule(fromWhom.href)}\n              >{fromWhom.title}</CellButton>\n            })}\n          </Div>\n        </>}\n      </ModalPage>\n    </ModalRoot>\n  )\n}\n\nexport default ActionsModal","import React from 'react';\nimport {\n  AppRoot,\n  ConfigProvider,\n  ScreenSpinner,\n  usePlatform,\n  View,\n} from '@vkontakte/vkui';\nimport bridge from '@vkontakte/vk-bridge'\nimport { useDispatch, useSelector } from 'react-redux';\nimport { GROUP_ID, MAIN_PANEL, SCHEDULE_PANEL, SEARCH_PANEL, SETTINGS_PANEL } from './constants';\nimport MainPanel from './panels/main';\nimport SchedulePanel from './panels/schedule';\nimport SearchPanel from './panels/search';\nimport SettingsPanel from './panels/settings';\nimport { RootState } from './store/rootReducer';\nimport ActionsModal from './components/ActionsModal';\nimport { requestGetUser, setUserData } from './store/slices/user';\nimport { requestConfigUnivers, setConfig, setCurrentUniver } from './store/slices/config';\nimport { setActiveModal } from './store/slices/navigation';\n\nlet isFirstLoading = true\nconst App: React.FC = () => {\n  const dispatch = useDispatch()\n  const { activePanel, history } = useSelector((s: RootState) => s.navigation)\n  const {\n    isLoaderShowing,\n    user,\n    isLoading: isUserLoading,\n    error: userError,\n    isUniverLoading,\n    isScheduleLoading,\n  } = useSelector((s: RootState) => s.user)\n  const { config, isLoading: isConfigLoading, error: configError, } = useSelector((s: RootState) => s.config)\n\n  const platform = usePlatform()\n\n  React.useEffect(() => {\n    document.body.setAttribute('scheme', 'space_gray')\n\n    const config =\n      window.location.search.slice(1)\n        .split('&')\n        .reduce((config, queryParam) => {\n          const [key, value] = queryParam.split('=')\n          return { ...config, [key.slice(3)]: value === '1' }\n        },{})\n    dispatch(setConfig(config))\n  },[])\n\n  const [popout, setPopout] = React.useState<React.ReactNode>(null)\n  const handleSetPopout = (popout: React.ReactNode) => {\n    setPopout(popout)\n  }\n\n  React.useEffect(() => {\n    const initApp = async () => {\n      // const userData = await bridge.send('VKWebAppGetUserInfo')\n      const userData = { id: 0 }\n      dispatch(setUserData(userData))\n      dispatch(requestConfigUnivers())\n      dispatch(requestGetUser(userData.id))\n    }\n\n    if(!user) initApp()\n  },[])\n\n  React.useEffect(() => {\n    if(user)\n    {\n      if(user.univer)\n        dispatch(setCurrentUniver(user.univer))\n      else\n        dispatch(setCurrentUniver(null))\n    }\n  }, [user])\n\n  React.useEffect(() => {\n    if(isUniverLoading || isScheduleLoading)\n    {\n      setPopout(<ScreenSpinner/>)\n    }\n    else\n    {\n      setPopout(null)\n    }\n  }, [isUniverLoading, isScheduleLoading])\n\n  React.useEffect(() => {\n    const openModal = async () => {\n      if(platform === 'android')\n      {\n        const addToHomeScreenInfo = await bridge.send('VKWebAppAddToHomeScreenInfo')\n        if(\n          addToHomeScreenInfo.is_feature_supported &&\n          addToHomeScreenInfo.is_added_to_home_screen\n        ) return\n      }\n\n      if(config.is_favorite) return\n\n      const groupInfo = await bridge.send(\n        'VKWebAppGetGroupInfo',\n        {'group_id': GROUP_ID}\n      )\n      if(groupInfo.is_member) return\n\n      dispatch(setActiveModal('actions'))\n    }\n    \n    if(\n      !isConfigLoading && !isUserLoading && !isFirstLoading &&\n      !userError && !configError &&\n      !isLoaderShowing\n    )\n    {\n      openModal()      \n    }\n    isFirstLoading = false\n  }, [isConfigLoading, isUserLoading, isLoaderShowing])\n\n  return (\n    <ConfigProvider isWebView={true}>\n      <AppRoot>\n        <View\n          popout={popout}\n          modal={<ActionsModal/>}\n          activePanel={activePanel}\n          history={history}\n        >\n          <MainPanel id={MAIN_PANEL} />\n          <SettingsPanel id={SETTINGS_PANEL} setPopout={handleSetPopout}/>\n          <SearchPanel id={SEARCH_PANEL} />\n          <SchedulePanel id={SCHEDULE_PANEL} setPopout={handleSetPopout}/>\n        </View>\n      </AppRoot>\n    </ConfigProvider>\n  )\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport bridge from '@vkontakte/vk-bridge'\nimport '@vkontakte/vkui/dist/vkui.css'\n\nimport store from './store'\nimport { Provider } from 'react-redux'\n\nimport './index.sass';\n\nimport App from './App';\n\nbridge.send('VKWebAppInit')\nbridge.subscribe(e => {\n  if(e.detail.type === 'VKWebAppUpdateConfig')\n    document.body.setAttribute('scheme', e.detail.data.scheme)\n})\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}